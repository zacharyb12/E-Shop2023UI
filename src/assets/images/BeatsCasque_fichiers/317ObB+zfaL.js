(function(k){var c=window.AmazonUIPageJS||window.P,m=c._namespace||c.attributeErrors,f=m?m("PageRefreshAsset",""):c;f.guardFatal?f.guardFatal(k)(f,window):f.execute(function(){k(f,window)})})(function(k,c,m){k.when("A","page-refresh-state","web-ajax-utility","alt-page-refresh-measurement","dp-interactive-page-refresh-handler","dp-click-to-ci-utils").register("page-refresh-handler",function(f,d,h,b,e,a){var g={},l=f.$,p=m,n="",q=function(b,g){var c=this;c.clientId=b;c.persistentParams={};c.pageRefreshUrlParams=
"";c.deviceType="";c.doPageRefresh=function(g,c,l,f){g=q(g,c);e.createInteractivityObjectForTwisterUpdate();var d;d=h.getInstance(b,g,{success:function(){var b=arguments[arguments.length-1];b&&!b.isResponseFromCache?p&&n&&(b=d.xhr.http.getResponseHeader("x-amz-rid"),p.setRequestId(n,b),n=""):a.logCounter("CachedTwisterMetric-Desktop");l.success.apply(null,arguments)},chunk:l.chunk,failure:l.failure},f);d.getContent()};c.addParams=function(a){c.persistentParams=l.extend(!0,c.persistentParams,a);return!0};
c.removeParams=function(a){f.each(a,function(a,b){delete c.persistentParams[a]});return!0};c.createCustomParamsMap=function(a,b){var g={Persistent:{},"Non-Persistent":{}};l.each(a,function(a,b){g.Persistent[a]=b});l.each(b,function(a,b){g["Non-Persistent"][a]=b});return g};c.startMeasurement=function(a,b,g,c,l,e){n=a;p&&p.start(a,b,g,c,l,e)};c.stampImageLoad=function(a){p&&p.stampImageLoad(a)};c.stampFeature=function(a,b){p&&p.stampFeature(a,b)};var q=function(a,b){c.persistentParams=l.extend(!0,
c.persistentParams,b.Persistent);var n={};l.extend(!0,n,c.persistentParams,b["Non-Persistent"]);b=g;var e=f.contains(b,"?");b=b+(e?"\x26":"?")+((a?"asin\x3d"+a:"")+(c.pageRefreshUrlParams?c.pageRefreshUrlParams:""));for(var d in n)null!=n[d]&&(a=n[d],e=b.slice(-1),b+="?"===e||"\x26"===e?"":"\x26",b+=d+"\x3d"+a);return b};(function(){var a=d.pageRefreshData;c.pageRefreshUrlParams=a.pageRefreshUrlParams;c.deviceType=a.deviceType})()};return{getHandlerInstance:function(a,e,d){(null==a||""===a)&&c.ueLogError&&
c.ueLogError({message:"Invalid ClientId"},{logLevel:"FATAL",attribution:"PageRefreshAPI",message:"Invalid ClientId passed to getHandlerInstance of dpRefreshHandler"});g[a]||(g[a]=new q(a,e));!p&&d&&(e=d.config,p=new b(l,e.atf.marker,e.cf.marker),p.setStoreId(n,d.storeID));return g[a]}}});"use strict";k.when("A","page-refresh-handler").register("dp-refresh-handler",function(f,d){function h(b,c,a){this.featureTriggeringRefresh=b.featureName;this.deviceType=(this.deviceTypeStateData=f.state("detail-page-device-type"))&&
this.deviceTypeStateData.deviceType?this.deviceTypeStateData.deviceType:"web";this.pageRefreshUrl=c&&c.pageRefreshUrl?c.pageRefreshUrl:"/gp/twister/ajaxv2";this.clientId="PageRefresh_"+this.deviceType+"_Client";this.DPRefreshHandler=d.getHandlerInstance(this.clientId,this.pageRefreshUrl,a)}h.prototype={doPageRefresh:function(b,e,a,g){try{this.DPRefreshHandler.doPageRefresh(b,e,a,g)}catch(l){c.ueLogError&&c.ueLogError(l,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the doPageRefresh method triggered by - "+
this.featureTriggeringRefresh})}},createCustomParamsMap:function(b,e){var a={};try{a=this.DPRefreshHandler.createCustomParamsMap(b,e)}catch(g){c.ueLogError&&c.ueLogError(g,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the createCustompParamsMap method triggered by - "+this.featureTriggeringRefresh})}return a},addParams:function(b){return b&&"object"==typeof b?this.DPRefreshHandler.addParams(b):!1},removeParams:function(b){return b&&"object"==typeof b?
this.DPRefreshHandler.removeParams(b):!1},startMeasurement:function(b,e,a,g,l,d){try{this.DPRefreshHandler.startMeasurement(b,e,a,g,l,d)}catch(n){c.ueLogError&&c.ueLogError(n,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the startMeasurement method triggered by - "+this.featureTriggeringRefresh})}},stampImageLoad:function(b){try{this.DPRefreshHandler.stampImageLoad(b)}catch(e){c.ueLogError&&c.ueLogError(e,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,
message:"This error is caused by the startMeasurement method triggered by - "+this.featureTriggeringRefresh})}},stampFeature:function(b,e){try{this.DPRefreshHandler.stampFeature(b,e)}catch(a){c.ueLogError&&c.ueLogError(a,{logLevel:"ERROR",attribution:this.featureTriggeringRefresh,message:"This error is caused by the startMeasurement method triggered by - "+this.featureTriggeringRefresh})}}};return h});k.when("A","jQuery","dp-interactive-page-refresh-handler","dp-click-to-ci-utils").register("alt-page-refresh-ajax-scope",
function(f,d,h,b){return function(e,a,g,l){this.scopeName=a;this.customPageTypeId=g;this.customTags=l;this.storeId="";this.CFmarked=this.requestIdAvailable=!1;ues("t0",a,c.newTwisterInteractionStartTime);ues("ctb",a,"1");this.signalMarker=function(a){!this.markers[a]||0>=this.markers[a].conditions||0===--this.markers[a].conditions&&"function"==typeof this.markers[a].handler&&this.markers[a].handler()};this.addlongPoleTag=function(a,b){a=a.toLowerCase();this.markers[a]&&0==this.markers[a].conditions&&
0==this.markers[a].conditions&&c.ue&&"function"===typeof ue.tag&&ue.tag(b)};this.markClickToCI=function(){var a=this,g=h.getClickToCIMetric();g&&g.then(function(g){uet("fn",a.scopeName,m,g.interactiveTime);a.requestIdAvailable&&uex("ld",lScopeName);b.logCounter("TTISuccessCountForTwisterUpdate")}).catch(function(a){b.logCounter("TTIFailureCountForTwisterUpdate")})};this.setStoreId=function(a){a&&(this.storeId=a)};this.setRequestId=function(a){a&&(this.CFmarked=this.requestIdAvailable=!0,this.postData(a))};
this.postData=function(a){var b=this.scopeName,g=this.customPageTypeId,d=this.customTags;c.ue&&ue.tag&&(c.ue_pty&&ue.tag(c.ue_pty),c.ue_spty&&ue.tag(c.ue_spty),ue.tag(c.ue_spty),ue.tag("main"),ue.tag(this.storeID),ue.tag("clientOnly"));if(this.requestIdAvailable&&this.CFmarked){ues("id",b,a);var e;g!==m&&(e=c.ue_pti,c.ue_pti=g);if(d!==m)for(a=0;a<d.length;a++)ue.tag(d[a]);uex("ld",b);g!==m&&(c.ue_pti=e)}};var d=this;this.markers={image:{conditions:1,handler:function(){uet("ne",a);d.signalMarker("af")}},
af:{conditions:Twister.atfMarkerCount?Twister.atfMarkerCount:2,handler:function(){f.trigger("PageRefresh:ATF");uet("af",a);uet("cf",a);d.signalMarker("cf");h.updateCriticalFeatures();d.markClickToCI()}},cf:{conditions:Twister.cfMarkerCount?Twister.cfMarkerCount:2,handler:function(){f.trigger("PageRefresh:CF");uet("cf",a);this.CFmarked=!0;d.postData()}}}}});k.when("A","jQuery","alt-page-refresh-ajax-scope").register("alt-page-refresh-measurement",function(f,d,h){return function(b,d,a){this.atfMarker=
d;this.cfMarker=a;this.scopeCount={};this.ajaxScopes={};this.start=function(a,d,e,f,k,m){c.ue&&(this.scopeCount[a]||(this.scopeCount[a]=0),d=a+(this.scopeCount[a]+1),this.scopeCount[a]++,this.ajaxScopes[a]=new h(b,d,k,m))};this.setRequestId=function(a,b){this.ajaxScopes[a]&&this.ajaxScopes[a].setRequestId(b)};this.setStoreId=function(a,b){this.ajaxScopes[a]&&this.ajaxScopes[a].setStoreId(requestId)};this.stampImageLoad=function(a){this.ajaxScopes[a]&&(this.ajaxScopes[a].signalMarker("image"),Twister.cfImageLongPollTag&&
this.ajaxScopes[a].addlongPoleTag("cf",Twister.cfImageLongPollTag))};this.stampFeature=function(a,b){this.ajaxScopes[b]?(a===this.atfMarker&&this.ajaxScopes[b].signalMarker("af"),a===this.cfMarker&&(this.ajaxScopes[b].signalMarker("cf"),Twister.cfHtmlLongPollTag&&this.ajaxScopes[b].addlongPoleTag("cf",Twister.cfHtmlLongPollTag))):a===this.cfMarker&&f.trigger("PageRefresh:AjaxCallCompletedButCFMarkingNotDone")};this.stampCustomMetrics=function(a,b){this.ajaxScopes[b]&&uet(a,this.ajaxScopes[b].scopeName)}}});
k.when("A","ready").register("page-refresh-state",function(c){var d=c.state("page-refresh-data");c=c.state("detail-page-device-type");var h={};"undefined"!==typeof d&&(h.pageRefreshUrlParams=d.pageRefreshUrlParams);"undefined"!==typeof c&&(h.deviceType=c.deviceType);return{pageRefreshData:h}});k.when("A","jQuery","dp-js-logger").register("web-ajax-utility",function(f,d,h){function b(a,b,c,d){this.scope=a;this.url=b;this.options=c;this.status=0;this.selected=!1;this.error=this.successData=this.xhr=
this._status=m;this.chunks=[];this.doNotAbort=d||!1}var e=new h("WebAjaxUtility");b._objects={};b.prototype._callback=function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);"function"===typeof a&&a.apply(self,b)};b.prototype._canAbort=function(){return!this.doNotAbort&&1===this.status};b.prototype._isAborted=function(){return 3===this.status};b.prototype._getUrl=function(){return this.url};b.prototype._abort=function(){if(1===this.status)try{this.ajaxRequestRefence.abort(),this.status=
3}catch(a){e.logFatal(a,{message:" Could not abort ajax request."})}};b.prototype._flushChunkData=function(){var a=this;a.chunks.length&&d.map(a.chunks,function(b){a._callback(a.options.chunk,b)})};b.prototype._request=function(){var a=this,b=c.performance&&performance.now,d=m,e=m;b&&(d=performance.now());a.ajaxRequestRefence=f.get(a.url,{params:a.options.params,success:function(h,k,m){a.status=4;b&&(e=performance.now());a.successData=h;a._status=k;a.xhr=m;a.selected&&a._callback(a.options.success,
h,k,m,{isResponseFromCache:!1});f.trigger("TwisterRefresh:Success");c.ue&&ue.count&&d&&e&&ue.count("TwisterApiCall",e-d)},error:function(b,c,d){a.status=2;a.xhr=b;a._status=c;a.error=d;a.selected&&a._callback(a.options.error,b,c,d)},abort:function(b){a.status=3;a.xhr=b;a.selected&&a._callback(a.options.abort,b)},chunk:function(b){b&&(a.chunks.push(b),a.selected&&a._callback(a.options.chunk,b))},timeout:a.options.timeout||4E4})};b.prototype.getContent=function(){b._abortRequestsExcept(this);this.selected=
!0;0===this.status?(this.status=1,this._request()):1===this.status?this._flushChunkData():4===this.status&&(this._flushChunkData(),this._callback(this.options.success,this.successData,this._status,this.xhr,{isResponseFromCache:!0}),f.trigger("a:pageUpdate"),f.trigger("TwisterRefresh:Success"))};b._abortRequestsExcept=function(a){d.each(b._objects[a.scope],function(b,c){c._canAbort()&&b!==a._getUrl()&&c._abort()})};b.getInstance=function(a,c,d,e){if(!a||!c||"object"!==typeof d)throw"Incorrect parameter passed.";
b._objects[a]=b._objects[a]||{};var f=b._objects[a][c];f&&f._isAborted()&&(delete b._objects[a][c],f=m);f||(b._objects[a][c]=new b(a,c,d,e,this));return b._objects[a][c]};return b});k.when("A").register("state-aware-critical-features",function(c){return function(){var c=[];this.add=function(f,b){for(var e=f.featureName,a=!1,g=0;g<c.length;g++)if(c[g].featureName===e){a=!0;break}if(a)throw"Critical Feature "+f.featureName+" already registered for State Aware Messaging!";f={};f.featureName=e;f.callback=
b;c.push(f)};this.getAllCriticalFeatures=function(){return c}}});k.when("A","state-aware-parameter-handler").register("state-aware-feature-consolidator",function(c,d){return{getStateAwareParameters:function(){return d.getStateAwareParameters()}}});k.when("A","state-aware-critical-features","state-aware-parameters").register("state-aware-parameter-handler",function(f,d,h){return new function(){var b=new d,e=new h;this.registerCriticalFeature=function(a,d){try{if("function"===typeof d)b.add(a,d);else throw"callback needs to be a function!";
}catch(e){c.ueLogError&&c.ueLogError(e,{logLevel:"ERROR",attribution:a.featureName,message:"StateAwareExceptionMessaging:- This error is caused by the feature "+a.featureName+" while registering itself as a critical feature for State Aware Messaging. "+e})}};this.getStateAwareParameters=function(){for(var a=b.getAllCriticalFeatures(),d=0;d<a.length;d++){var f=a[d],h=f.featureName,f=f.callback.apply();try{e.putParameters(h,f)}catch(k){c.ueLogError&&c.ueLogError(k,{logLevel:"ERROR",attribution:h,message:"StateAwareMessaging:- This error is caused by the feature "+
h+" while injecting state aware parameters. "+k})}}return e.getAllStateAwareParameters()}}});k.when("A").register("state-aware-parameters",function(){return function(){var c={};this.putParameters=function(d,h){var b=!0;for(feature in c)if(c.hasOwnProperty(feature)&&d!==feature){var e=this.getParameters(feature);if(b){var b=h,a=!1;for(paramKey in b)if(b.hasOwnProperty(paramKey)&&e.hasOwnProperty(paramKey)){a=!0;break}b=!a}}if(b)for(paramKey in h)h.hasOwnProperty(paramKey)&&(e=h[paramKey],c[d]||(c[d]=
{}),c[d][paramKey]=e);else throw"Duplicate Parameters found for other Critical Feature!";};this.getParameters=function(d){return c[d]};this.getAllStateAwareParameters=function(){var d={},h;for(h in c)if(c.hasOwnProperty(h)){var b=this.getParameters(h),e;for(e in b)b.hasOwnProperty(e)&&(d[e]=b[e])}return d}}});k.when("A").register("page-refresh-utils",function(f){var d=f.$,h={intermediateEOS:1,EOS:1};return{fadeInFeatures:function(b){d.each(b,function(a,c){"#"!==c[0]&&(b[a]="#"+c)});var c=b.join(",");
d(c).addClass("js-feature-refresh-overlay");d(c).css("opacity",.5)},refreshFeature:function(b){var e=b.Value;b=b.FeatureName;if(!h[b]){var a,f;try{b&&e&&e.content&&(f=e.content[b],"undefined"!==typeof f&&(a=d("#"+b),a.html(f),a.removeClass("js-feature-refresh-overlay"),a.css("opacity","")))}catch(k){e={message:"Error in feature"+(b||"NoFeatureName"),logLevel:"FATAL"},c.ueLogError&&c.ueLogError(k,e)}}},removeOverlayForAllFeatures:function(b){b=d("body").find(".js-feature-refresh-overlay");for(var c=
0;c<b.length;c++){var a=b[c];d(a).removeClass("js-feature-refresh-overlay");d(a).css("opacity","")}}}})});