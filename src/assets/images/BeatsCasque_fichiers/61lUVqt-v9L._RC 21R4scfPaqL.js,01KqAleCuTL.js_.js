(function(g){var q=window.AmazonUIPageJS||window.P,y=q._namespace||q.attributeErrors,d=y?y("TurboCheckoutBaseAssets",""):q;d.guardFatal?d.guardFatal(g)(d,window):d.execute(function(){g(d,window)})})(function(g,q,y){"use strict";g.register("turbo-function-adapter",function(){return{adapt:function(d){return function(){if("function"!==typeof d)throw"Parameter 'property' is invalid. Expected a function but got "+typeof d;return d.apply(d,arguments)}}}});"use strict";g.when("turbo-configuration","turbo-function-adapter").execute("turbo-signin-adapter-factory",
function(d,a){g.when(d.get(d.KEYS.SHOW_SIGN_IN_INTERFACE)).register("turbo-signin-adapter",function(c){return{show:a.adapt(c.show)}})});"use strict";g.when("turbo-configuration","turbo-function-adapter").execute("turbo-view-adapter-factory",function(d,a){g.when(d.get(d.KEYS.VIEW_ADAPTER)).register("turbo-view-adapter",function(c){return{registerCallbacks:a.adapt(c.registerCallbacks),close:a.adapt(c.close),show:a.adapt(c.show),removeContent:a.adapt(c.removeContent),setContent:a.adapt(c.setContent),
closeImmediatelyThenExecute:a.adapt(c.closeImmediatelyThenExecute),closeAndNavigate:a.adapt(c.closeAndNavigate),closeToFullscreen:a.adapt(c.closeToFullscreen),updateBounds:a.adapt(c.updateBounds),getHeight:a.adapt(c.getHeight),updateMinHeight:a.adapt(c.updateMinHeight),updateScrollHeight:a.adapt(c.updateScrollHeight)}})});"use strict";g.when("turbo-checkout-page-ready").execute(function(){g.declare("turbo-eligibility-override",!1)});"use strict";g.when("A","turbo-checkout-csm","turbo-configuration",
"turbo-checkout-page-ready").register("turbo-checkout-address-id",function(d,a,c){function b(c){for(var b=0;b<c.length;b++){var d=e(c[b]);if(0<d.length)return a.logCount("turboCheckoutAddressSelectorIndex"+b),d}a.logCount("turboCheckoutAddressSelectorMissing");return e()}var e=d.$;return{getAddressId:function(){return b(c.get(c.KEYS.ADDRESS_INPUT_SELECTORS)).val()||""},set:function(a){b(c.get(c.KEYS.ADDRESS_INPUT_SELECTORS)).val()!==a&&b(c.get(c.KEYS.ADDRESS_INPUT_SELECTORS)).val(a).trigger("change",
[a])}}});"use strict";g.when("A","turbo-checkout-utils","turbo-callback-list","turbo-configuration","turbo-checkout-load-events","turbo-checkout-page-ready").register("turbo-checkbox-exclusion-listener",function(d,a,c,b,e){function f(a){var c=p;p=!1;for(var b=0;b<n.length;b++){var e=m(n[b]).find("input[type\x3dcheckbox]");a(e)}c!==p&&(h("Exclusion checkbox state changed"),r.callAll("exclusionCheckbox"))}function k(a){var b;if(!(b=p)){b=!1;for(var c=0;c<a.length&&!b;c++){var e=m(a[c]);(b=e.prop("checked"))&&
h("Exclusion checkbox is checked",e)}}p=b}function h(b,c){a.logDebug("turbo-checkbox-exclusion-listener",b,c)}function l(){f(k)}var n=b.get(b.KEYS.CHECKBOX_EXCLUSION_ROOT_NODES),m=d.$,r=c.create(),p=!1;e.bind(function(){f(function(a){h("Listening for change events on:",a);a.unbind("change",l).bind("change",l);k(a)})});return{onStateChange:function(a){r.push(a)},isAnyCheckboxChecked:function(){return p}}});"use strict";g.when("A","turbo-callback-list","turbo-checkout-load-events","turbo-checkout-page-ready").register("turbo-checkout-custom-price-input",
function(d,a,c){function b(){var a=e();h!==a&&(h=a,k.callAll())}function e(){return f("#gcPriceOverride").val()||""}var f=d.$,k=a.create(),h;c.bind(function(){h=e();f("#gcPriceOverride").unbind("change",b).bind("change",b)});return{getCustomPrice:e,onChange:function(a){k.push(a)}}});"use strict";g.when("A","turbo-checkout-csm","turbo-checkout-utils","turbo-configuration","turbo-callback-list","turbo-checkout-load-events","turbo-checkout-page-ready").register("turbo-checkout-quantity-input",function(d,
a,c,b,e,f){function k(a){var b=a?a.value?parseInt(a.value,10):a.target&&a.target.value?parseInt(a.target.value,10):void 0:void 0;p===b?c.logDebug("turbo-checkout-quantity-input","Quantity change event does NOT have new quantity. Suppressing callbacks",void 0):(p=b,c.logDebug("turbo-checkout-quantity-input","Quantity change event",a),n.callAll())}function h(b){b=b.val();(b=parseInt(b,10))||a.logCount("turboCheckoutNoQuantityFromPage");return b}var l=d.$,n=e.create(),m=b.get(b.KEYS.QUANTITY_SELECT_SELECTOR),
r="Multiple quantity nodes present on the page. This may lead to an incorrect quantity being used in Turbo! Selector \x3d "+m,p;f.bind(function(){var b=l(m);p=h(b);b.unbind("change",k).bind("change",k);1<b.length&&(c.logError(r,"turbo-checkout-quantity-input"),c.logDebug("turbo-checkout-quantity-input",r,b));a.logCount("turboCheckoutQuantityNodes",b.length)});return{getQuantity:function(){return h(l(m))},setQuantity:function(a){var b=l(m),c=h(b);a=parseInt(a,10);c!==a&&b.val(a).change()},onChange:function(a){n.push(a)}}});
"use strict";g.when("A","turbo-checkout-csm","turbo-checkout-utils","turbo-callback-list","turbo-configuration","turbo-checkout-quantity-input","turbo-checkout-load-events","turbo-checkout-page-ready").register("turbo-checkout-warranty-input",function(d,a,c,b,e,f,k){var h=d.$,l=b.create(),n=e.get(e.KEYS.WARRANTY_CHECKBOX_INPUT_SELECTOR),m=e.get(e.KEYS.WARRANTY_CHECKBOX_RELATIVE_PARENT_SELECTOR),r=e.get(e.KEYS.WARRANTY_ASIN_INPUT_NAME),p=e.get(e.KEYS.WARRANTY_OFFER_INPUT_SELECTOR);k.bind(function(){h(n).unbind("click",
l.callAll).bind("click",l.callAll)});return{select:function(a){a&&h(m+" input[name^\x3d"+r+"][value\x3d"+a+"]").parents(m).find(n).click()},onChange:function(a){l.push(a)},getLineItem:function(b){if(h(n+":checked").length){var e=h(n+":checked").first().parents(m).find("input[name^\x3d"+r+"]").val()||"",d=h(p).val()||"";b=parseInt(b,10)||f.getQuantity()||1;if(e&&d)return{asin:e,offerListingId:d,quantity:b,isDiscoveredAsin:!0};a.logCount("turboCheckoutIncompleteWarrantyInputs");c.logError("Incomplete input data for the selected warranty checkbox - asin:"+
e+", offerId:"+d+", quantity:"+b)}else c.logDebug("turbo-checkout-warranty-input","No warranty checkbox is selected",void 0)}}});"use strict";g.when("A","turbo-checkout-csm","turbo-callback-list","turbo-configuration","turbo-checkout-load-events","turbo-checkout-page-ready").register("turbo-checkout-vas-input",function(d,a,c,b,e){function f(){return n(h).prop("checked")||!1}function k(){var a=r;r=f();a!==r&&m.callAll(r)}var h=b.get(b.KEYS.VAS_CHECKBOX_SELCTOR),l=b.get(b.KEYS.VAS_CHANGE_EVENTS),n=
d.$,m=c.create(),r;e.bind(function(){r=f();l.forEach(function(a){d.off(a,k);d.on(a,k)})});return{isSelected:f,onChange:function(a){m.push(a)}}});"use strict";g.when("A","turbo-checkout-utils","turbo-callback-list","turbo-checkout-load-events","turbo-checkout-csm","turbo-checkout-aui-page-state-parser","turbo-configuration","turbo-checkout-page-ready").register("turbo-checkout-accessories-input",function(d,a,c,b,e,f,k){function h(){var a=w;w=B();w!==a&&u.callAll()}function l(){if(z===y&&v(t).length){var a=
f.parse("simpleBundleParameterMap",".simpleBundleFeatureContainer");0===a.length?(e.logCount("Turbo:Accessories:No:State"),z={}):n(a)}}function n(a){z={};a[0].items.forEach(function(a){z[a.asin]={asin:a.asin,offerListingId:a.offerListingId,isDiscoveredAsin:!0}})}function m(){return v(t).find("input[type\x3dcheckbox]")}function r(){m().unbind("change",h).bind("change",h)}function p(){return v(t).length?1>=w:0===w}function B(){var b=0;m().each(function(){v(this).prop("checked")&&b++});a.logDebug("turbo-checkout-accessories-input",
"Accessories selected "+b);return b}var v=d.$,u=c.create(),w=0,z,t=k.get(k.KEYS.ENABLED_ACCESSORIES_SELECTOR);l();r();b.bind(function(){l();r();B()});return{isEligible:p,registerCallback:function(a){u.push(a)},getLineItem:function(){if(p()){var a=m().filter(":checked").val();a=z?z[a]:void 0;return a||y}return y},select:function(a){a&&v(t+" input[type\x3dcheckbox][value\x3d"+a+"]").click()}}});"use strict";g.when("A","turbo-checkout-csm","turbo-configuration","turbo-checkout-page-ready").register("turbo-checkout-session-id-input",
function(d,a,c){var b=d.$;return{getSessionId:function(){var e=b(c.get(c.KEYS.SESSION_ID_SELECTOR));e&&0<e.length||(a.logCount("turboCheckoutSessionIdSelectorMissing"),e=b());return e.val()||""}}});"use strict";g.when("A","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-form","turbo-checkout-ref-tagger","turbo-checkout-page-state","turbo-checkout-product-state","turbo-checkout-page-ready").register("turbo-checkout-joined-state",function(d,a,c,b,e,f,k){function h(a,b,c){b&&(c&&(b.quantity=
c),a.push(b))}function l(c,f){function k(){var b=c.turboWeblab;b||a.logCount("turboCheckoutWeblabNameNotDefinedInState");return b}function l(){return c.turboWeblabTreatment}this.pageState=c;this.productStates=f;this.getLineItems=function(){return h.lineItemInputs};this.getActiveId=function(){return h.id};this.getHeaderText=function(){return h?h.turboHeaderText||c.turboHeaderText:c.turboHeaderText};this.getLoadingText=function(){return c.turboLoadingText};this.getAddressId=function(){return c.addressId};
this.getRequestId=function(){return c.requestId};this.getSessionId=function(){return c.sessionId};this.getAdditionalWeblabs=function(){return c.additionalWeblabs};this.getInitiateSelector=function(){return c.initiateSelector};this.getWeblab=k;this.getWeblabTreatment=l;this.isTurboLaunched=function(){return!k()&&"C"!==l()};this.isProductStateEligible=function(){return f.isTurboEligible};this.getRefTag=function(){if(!h)throw"Turbo checkout product state is NOT resolved. Cannot generate ref tag";var a=
d.$("#"+h.id);a=b.getRefTag(a);return e.generateJoinedValue(a)};this.getCSRFToken=function(){return c.csrfToken};this.getClientId=function(){return h&&h.checkoutClientId?h.checkoutClientId:"retailwebsite"};this.resolve=function(a){if(a){h=f.states[a];if(!h)throw a="Resolved turbo checkout product state is undefined. Id \x3d "+a,n(a,f),a;n("Resolved new product state",h);d.trigger("turbo:checkout:state:product:resolved")}};var h=1!==f.states.length?y:f.states[0]}function n(a,b){c.logDebug("turbo-checkout-joined-state",
a,b)}return{createTurboState:function(b,c,e,d,v,u){if(d&&e)throw"Custom item price is NOT supported with warranty";var p=f.get();c&&(p.addressId=c);c=k.get();if(b||d||e||u)b=parseInt(b,10),c.states.forEach(function(c){c.lineItemInputs.forEach(function(c){b&&(c.quantity=b);d?(c.customItemPrice=d,a.logCount("turboCheckoutItemPriceOverrided")):c.customItemPrice&&a.logCount("turboCheckoutItemPriceSelectorFallBackToTurboState")});h(c.lineItemInputs,u,b);h(c.lineItemInputs,e,b)});p=new l(p,c);p.resolve(v);
return p}}});"use strict";g.when("A","turbo-checkout-csm","turbo-checkout-utils","turbo-configuration","turbo-checkout-aui-page-state-parser","turbo-constants","turbo-checkout-page-ready").register("turbo-checkout-page-state",function(d,a,c,b,e,f){function k(a,b,c,e,d,h,k,l,m,r,n,g){this.version=a;this.turboWeblab=b;this.turboWeblabTreatment=c;this.initiateSelector=e;this.turboLoadingText=d;this.turboHeaderText=h;this.addressId=k;this.requestId=l;this.sessionId=m;this.csrfToken=r;this.turboAssetsMode=
n;this.isJavaPipelineEligible="0"!==this.version&&this.turboAssetsMode!==f.ASSET_MODE_TURBO_ONLY;this.additionalWeblabs=g}function h(a,b){c.logDebug("turbo-checkout-page-state",a,b)}var l=b.get(b.KEYS.TURBO_PAGE_STATE_KEY),n=b.get(b.KEYS.PAGE_STATE_PARSING_ROOT_NODE_SELECTOR),m=b.get(b.KEYS.LEGACY_SESSION_ID_IDENTIFIER),r=new k("0","","C","#buy-now-button","","","","","","",f.ASSET_MODE_TURBO_ONLY,"");return{get:function(b,d){b:{b=b||l;d=d||n;d=e.parse(b,d);a.logCount("turboCheckoutPageStates",d.length);
if(1<d.length)c.logError("Multiple turbo checkout page states found! Turbo will NOT show","turbo-checkout-page-state",void 0),h("PageStates",d);else if(0===d.length)h("Turbo checkout page state ["+b+"] is NOT present");else{b=d[0];break b}b=void 0}if(b)if(b.version)b=new k(b.version,b.turboWeblab||"",b.turboWeblabTreatment||"C",b.initiateSelector||".buy-now-button",b.turboLoadingText||"",b.turboHeaderText||"",b.addressId||"",b.requestId||"",b.sessionId||"",b.csrfToken||"",b.turboAssetsMode||f.ASSET_MODE_TURBO_ONLY,
b.additionalWeblabs||"{}");else{d=b.inputs||{};var v=b.strings||{};b=new k("1",b.turboWeblab||"",b.turboWeblabTreatment||"C",(b.configurations||{}).initiateSelector||"#buy-now-button",v.TURBO_LOADING_TEXT||"",v.TURBO_CHECKOUT_HEADER||"",d.addressId||"",d.requestId||"",d.sessionId||d[m]||"",b.csrfToken||"",b.turboAssetsMode||f.ASSET_MODE_TURBO_ONLY,b.additionalWeblabs||"{}")}else a.logCount("turboCheckoutStateNotDefined"),b=r;h("Turbo Checkout PageState",b);return b}}});"use strict";g.when("A","turbo-checkout-csm",
"turbo-checkout-utils","turbo-configuration","turbo-checkout-aui-page-state-parser","turbo-checkout-page-ready").register("turbo-checkout-product-state",function(d,a,c,b,e){function f(a,b){this.isTurboEligible=a;this.states=b}function k(a,b,c,d,e){this.id=a;this.isTurboEligible=b;this.lineItemInputs=c;this.turboHeaderText=d||"";this.checkoutClientId=e}function h(a,b,c,d,e,f,h,k,l,m){this.asin=b||"";this.offerListingId=c||"";this.quantity=parseInt(d,10)||1;this.isTurboEligible=!!this.asin&&!!this.offerListingId&&
a;this.productTitle=e||"";this.incentivizedCart=f||"";this.customItemPrice=h||"";this.addToCartTimeAsUnixEpochMilliseconds=k||"";this.addToCartSessionId=l||"";this.isDiscoveredAsin=!!m}function l(a,b){c.logDebug("turbo-checkout-product-state",a,b)}function n(a){if(!a.lineItemInputs||!a.lineItemInputs.length||!a.id)return l('Versioned product state is invalid. Expected non empty "id" and "lineItemInputs". Turbo may NOT show',a),p;var b=!0,c=d.map(a.lineItemInputs,function(a){a=new h(a.isTurboEligible,
a.asin,a.offerListingId,a.quantity,a.productTitle,a.incentivizedCart,a.customItemPrice,a.addToCartTimeAsUnixEpochMilliseconds,a.addToCartSessionId,a.isDiscoveredAsin);b=b&&a.isTurboEligible;return a});return new k(a.id,b,c,a.turboHeaderText,a.checkoutClientId)}var m=b.get(b.KEYS.TURBO_PRODUCT_STATE_KEY),r=b.get(b.KEYS.PRODUCT_STATE_PARSING_ROOT_NODE_SELECTOR),p=new k("buy-now-button",!1,[],"","retailwebsite"),B=new f(!1,[p]);return{get:function(b,d){b=b||m;d=d||r;d=e.parse(b,d);a.logCount("turboCheckoutProductStates",
d.length);1<d.length&&"turbo-checkout-page-state"===b?(c.logError("turbo-checkout-page-state only supports the single item use case! Turbo will NOT show","turbo-checkout-product-state",void 0),b=[]):b=d;if((d=b)&&d.length){var u=!1;b=[];for(var v=0;v<d.length;v++){var t=d[v];if(t)if(t.version)var g=n(t);else t.inputs&&t.eligibility?(g=t.strings||{},t=new h(t.eligibility.isEligible,t.inputs.a,t.inputs.oid,t.inputs.quantity,g.TURBO_CHECKOUT_HEADER,t.inputs.incentivizedCart,t.inputs.customItemPrice),
g=new k("buy-now-button",t.isTurboEligible,[t],g.TURBO_CHECKOUT_HEADER,"retailwebsite")):(l('Legacy product state is missing "inputs" or "eligibility". Turbo will NOT show',t),g=p);else l("Product state parsed DOM object is invalid. Turbo may NOT show",t),g=p;u=u||g.isTurboEligible||!1;t=g.id;if(b[t])throw d="Duplicate product state found. id \x3d "+t,l(d,b),d;b.push(g);b[g.id]=g}b=new f(u,b)}else l("Parsed states are invalid. Turbo will NOT show",d),b=B;l("Turbo Checkout Product State(s)",b);return b}}});
"use strict";g.when("A","turbo-configuration","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-auto-open","turbo-checkout-address-id","turbo-checkout-quantity-input","turbo-checkout-warranty-input","turbo-checkout-custom-price-input","turbo-callback-list","turbo-checkout-joined-state","turbo-checkout-accessories-input","turbo-checkout-session-id-input","turbo-checkout-page-ready").register("turbo-checkout-state-handler",function(d,a,c,b,e,f,k,h,l,n,m,r,p){function g(a,b,c,d,e,u){a=a||k.getQuantity();
b=b||f.getAddressId();c=c||h.getLineItem(a);d=d||l.getCustomPrice();u=u||r.getLineItem();return m.createTurboState(a,b,c,d,e,u)}function v(a,c){b.logDebug("turbo-checkout-state-handler",a,c)}function u(a,c){b.logWarning("turbo-checkout-state-handler",a,c)}function w(a,b,c,d,e){x=g(a,b,c,y,d,e)}function z(){d.trigger("turbo:checkout:product:onChange");E.callAll()}function t(){var a=g();b.isDeepEquals(x,a)||(x=a,v("New Turbo State",x),z())}var q=d.$,H=a.get(a.KEYS.AJAX_PAGE_UPDATE_EVENT),E=n.create(),
D=!1;var x=g();return{isProductTurboEligible:function(){return!D&&x.isProductStateEligible()||a.get(a.KEYS.OVERRIDE_ELIGIBILITY)},getLineItems:function(){return x.getLineItems()},getAddressId:function(){return x.getAddressId()},getWeblabAllocation:function(){return x.getWeblabTreatment()},registerCallback:function(a){E.push(a)},startMonitoringPage:function(){e.updateInputsAndThen(w);k.onChange(t);h.onChange(t);l.onChange(t);r.registerCallback(t);d.off(H,t);d.on(H,t);z()},getRequestId:function(){return x.getRequestId()},
getSessionId:function(){return x.getSessionId()},getExperimentName:function(){return x.getWeblab()},getAdditionalWeblabAndTreatmentMap:function(){try{return JSON.parse(x.getAdditionalWeblabs())}catch(C){c.logCount("turboCheckoutParseAdditionalWeblabsException"),u("JSON::parse exception. Exception \x3d "+C)}},getStrings:function(){return{TURBO_LOADING_TEXT:x.getLoadingText(),TURBO_CHECKOUT_HEADER:x.getHeaderText()}},getInitiateSelector:function(){return x.getInitiateSelector()},isTurboLaunched:function(){return x.isTurboLaunched()},
isPhysicalGiftCardExperimentEligible:function(){var a=0!==q("#giftcardcustomtwister_feature_div").length;a&&(v("Physical Gift Card use case"),c.logCount("turboCheckoutGiftCardUseCase"));return a},setTurboStateNotEligible:function(){D=!0},resolveProductState:function(a){x.resolve(a)},getActiveId:function(){return x.getActiveId()},getRefTag:function(){return x.getRefTag()},getCSRFToken:function(){var a;(a=x.getCSRFToken())||(a=(a=x.getSessionId())&&0<a.length?a:p.getSessionId());a=a||"";if(!a||0>=a.length)u("CSRF Token is empty. This will result in denied requests."),
c.logCount("turboCheckoutNoValidCSRFToken");return a},getClientId:function(){return x.getClientId()}}});"use strict";g.when("A","turbo-checkout-utils","turbo-checkout-page-ready").register("turbo-checkout-aui-page-state-parser",function(d,a){var c=d.$;return{parse:function(b,d){b="script[data-a-state*\x3d'"+b+"'], #"+b;d=d?c(d).find(b):c(b);b=[];for(var e=0;e<d.length;e++){a:{try{var k=c(d[e]).text();var h=JSON.parse(k);break a}catch(l){a.logError("JSON::parse exception. Exception \x3d "+l,"turbo-checkout-aui-page-state-parser",
void 0)}h=void 0}h&&b.push(h)}return b}}});"use strict";g.when("A","turbo-checkout-page-state","turbo-checkout-csm","turbo-checkout-state-handler","tango-checkout-urls","turbo-checkout-page-ready").register("tango-checkout-eligibility",function(d,a,c,b,e){function f(){var a={},c=b.getAddressId();c&&(a.addressID=c);return a}function k(a){n();r=null;a&&a.isTangoEligible?(c.logCount("tangoCheckoutCustomerEligible"),p&&p()):(l(""),c.logCount("tangoCheckoutCustomerNotEligible"),B&&B())}function h(){n();
r=null;l("");c.logCount("tangoCheckoutCustomerEligibilityCallFailed")}function l(a){g.when("ready").execute(function(){d.state("checkout-url-migration-page-state",{checkoutUrl:a})})}function n(){var a=(new Date).getTime()-m;c.logCount("tangoCheckoutCustomerEligibilityTime",a)}var m,r,p,B;return{setEligibleCallback:function(a){p=a},setIneligibleCallback:function(a){B=a},isEligibleFromPageState:function(){return a.get().isJavaPipelineEligible},checkEligibility:function(){m=(new Date).getTime();r&&(r.abort(),
r=null);var a=e.buildEligibilityPathWithParams();r=d.$.ajax(a,{type:"POST",data:f(),success:k,error:h})},setTangoPageStateUrl:l}});"use strict";g.when("turbo-configuration","turbo-shopping-portal-switch","turbo-checkout-page-ready").register("tango-checkout-urls",function(d,a){function c(a,b){b=b.join("\x26");return a+"?"+b}var b="unknown";return{buildEligibilityPathWithParams:function(){var e=a.isShoppingPortalEnabled()?"/checkout/turbo/tango-eligibility":"/checkout/tango-eligibility",f="chk_"+b+
"_eligibility";f=["pipelineType\x3dChewbacca","referrer\x3d"+d.get(d.KEYS.HOST_PAGE_TYPE_IDENTIFIER),"ref_\x3d"+f,"isAsync\x3d1"];return c(e,f)},buildProceedToCheckoutPathWithParams:function(a){a=a||"/checkout/entry/cart";var e="ox_"+b+"_proceed";e=["pipelineType\x3dChewbacca","referrer\x3d"+d.get(d.KEYS.HOST_PAGE_TYPE_IDENTIFIER),"ref_\x3d"+e];return c(a,e)},setRefMarkerPageContext:function(a){b=a}}});"use strict";g.when("jQuery","turbo-checkout-auto-open","turbo-checkout-page-ready").register("turbo-checkout-page-load-spinner",
function(d,a){function c(){0!==d("#turbo-checkout-auto-load-spinner-container").length&&(d("#turbo-checkout-auto-load-spinner-container").remove(),e.unbind("touchmove touchstart touchend touchcancel click scroll",b))}function b(a){a.preventDefault();a.stopPropagation()}var e=d("body");a.isAutoOpenEligible()&&(e.bind("touchmove touchstart touchend touchcancel click scroll",b),e.append("\x3cdiv id\x3d'turbo-checkout-auto-load-spinner-container' class\x3d'turbo-checkout-auto-load-spinner-container'\x3e\x3cdiv id\x3d'turbo-checkout-auto-load-circle-container' class\x3d'turbo-checkout-auto-load-circle-container'\x3e\x3cdiv id\x3d'turbo-checkout-auto-load-spinner' class\x3d'a-spinner a-spinner-medium turbo-checkout-auto-load-spinner'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"),
setTimeout(c,5E3));return{removePageLoadSpinner:c}});"use strict";g.when("turbo-configuration","turbo-checkout-ref-tagger","turbo-checkout-utils","turbo-shopping-portal-switch","turbo-checkout-page-ready").register("turbo-checkout-urls",function(d,a,c,b){function e(){return b.isShoppingPortalEnabled()?"/checkout/turbo/initiate":"/checkout/turbo-initiate"}function f(a,b,c){a="\x26pipelineType\x3dturbo\x26clientId\x3d"+a;var e=d.get(d.KEYS.DEVICE_OVERRIDE);return a+(e?"\x26devicestring-override\x3d"+
e:"")+m(b,c)}function k(a){var b=d.get(d.KEYS.HOST_PAGE_TYPE_IDENTIFIER);return"ref_\x3d"+a+"\x26referrer\x3d"+b}function h(a){return c.isNonEmptyString(a)?"\x26weblab\x3d"+a:""}function l(){return d.get(d.KEYS.IS_ADD_TO_CART_ENABLED)?"\x26temporaryAddToCart\x3d1":""}function n(a){if(!a||!a.length)return"";d.get(d.KEYS.IS_ADD_TO_CART_ENABLED)||c.logError('Discovered asins present but add to cart is disabled? This will generate a "clickstream_ignore" hit on the server side and cause the hit to be ignored by clickstream and the attribution lost!',
"turbo-checkout-urls");var b="";a.forEach(function(a,c){b+="\x26discoveredAsins."+c+"\x3d"+a});return b}function m(a,b){var d="";c.isNonEmptyString(a)&&(d+="\x26pageRequestId\x3d"+a);c.isNonEmptyString(b)&&(d+="\x26pageSessionId\x3d"+b);return d}function r(){return b.isShoppingPortalEnabled()?"/checkout/turbo/triggerWeblab":"/checkout/triggerWeblab"}function p(){return v("auiDebug","auiDebug")+v("ds_user","ds_user")+v("ds_turbo_workspace","ds_workspace")+v("stringDebug","stringDebug")}function g(a){a=
a?a:[];var b="";a.forEach(function(a,c){b+="\x26asin."+(c+1)+"\x3d"+a.asin});return b}function v(a,b){var d="";a=c.getUrlQueryParam(a);c.isNonEmptyString(a)&&(d="\x26"+b+"\x3d"+a);return d}return{buildInitiatePathWith:function(a,b,c,d,m,r){return e()+"?"+k(a)+f(c,d,m)+h(b)+l()+p()+g(r)},buildEligibilityPathWith:function(a,b,c,d,m){return e()+"?"+k(a)+f(c,d,m)+h(b)+"\x26checkEligibilityOnly\x3dtrue"+l()+p()},buildConfirmPathWith:function(a,b,c,d,m,r){return e()+"/confirm?"+k(a)+f(c,d,m)+h(b)+l()+n(r)},
buildLogPageHitPathWith:function(c,d,e){return(b.isShoppingPortalEnabled()?"/checkout/turbo/log-page-hit":"/checkout/log-page-hit")+"?"+a.generateRefTag(c,a.ACTIONS.CLOSE,d)+f(e)},buildTriggerWeblabPathWith:function(a,b,c,d,e){return r()+"?"+k(a)+h(b)+"\x26weblabAllocation\x3d"+c+m(d,e)},buildTriggerWeblabPathWithoutWeblab:function(a,b,c){return r()+"?"+k(a)+m(b,c)}}});"use strict";g.when("turbo-checkout-page-ready").register("turbo-callback-list",function(){function d(){var a=[];this.callAll=function(){for(var c=
0;c<a.length;c++){var b=a[c];b.apply(b,arguments)}};this.push=function(c){if("function"!==typeof c)throw"Invalid callback. Expected typeof 'callback' to be 'function'. typeof \x3d "+typeof c;-1===a.indexOf(c)&&a.push(c)};this.remove=function(c){c=a.indexOf(c);-1!==c&&a.splice(c,1)}}return{create:function(){return new d}}});"use strict";g.when("turbo-callback-list","turbo-checkout-page-ready").register("turbo-filtered-callback-list",function(d){function a(a){var b=d.create();this.callAll=b.callAll;
this.remove=b.remove;this.push=function(c){(c=c[a])&&"function"===typeof c&&b.push(c)}}return{create:function(c){if(!c||"string"!==typeof c)throw"Invalid filter parameter. Expected 'filter' to be a non empty string. typeof \x3d "+typeof c+" value \x3d "+c;return new a(c)}}});"use strict";g.when("A","turbo-configuration","turbo-checkout-utils","turbo-checkout-page-ready").register("turbo-checkout-form",function(d,a,c){function b(b){var c=a.get(a.KEYS.FORM_SELECTOR_OVERRIDE);if(c&&0<e(c).length)return e(c);
c=a.get(a.KEYS.FORM_TYPE);if("link"===c)return b.find("a");if("form"===c)return b.closest("form");throw"Unsupported FORM_TYPE is configured. value \x3d "+c;}var e=d.$,f=/[\/?&]ref_?=([^?&]+)/;return{getForms:b,getRefTag:function(a){if(1!==a.length)return c.logError("Expected getRefTag input to have a single element. Cannot resolve refTag as this is a data quality risk","turbo-checkout-form"),c.logDebug("turbo-checkout-form","Expected getRefTag input to have a single element. Cannot resolve refTag as this is a data quality risk",
a),"";a=b(a);a=((a.attr("action")||a.attr("href")||"")+"\x26"+a.serialize()).match(f)||{};return 2===a.length?a[1]:""}}});"use strict";g.when("A","turbo-checkout-page-ready").register("turbo-checkout-ajax-wrapper",function(d){return{load:function(a,c){c.hasOwnProperty("timeout")||(c.timeout=2E4);return d.ajax(a,c)},loadWithJQXHR:function(a,c){c.hasOwnProperty("timeout")||(c.timeout=2E4);return d.$.ajax(a,c)},createXHRRequest:function(){var a=new XMLHttpRequest;a.timeout=2E4;return a}}});"use strict";
g.when("A","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-session-storage","turbo-checkout-quantity-input","turbo-checkout-address-id","turbo-checkout-warranty-input","turbo-checkout-accessories-input","turbo-checkout-page-ready").register("turbo-checkout-auto-open",function(d,a,c,b,e,f,k,h){function l(a,b){c.logDebug("turbo-checkout-auto-open",a,b)}function n(){return m()&&0!==v}function m(){var d;if(d="1"===w.trb_open||"1"===c.getUrlQueryParam("trb_open"))(d=b.isPresent("hasTurboAutoOpened"))&&
a.logCount("turboCheckoutAutoOpenLoopPrevented"),d=!d;return d}function r(){return 1===v&&m()}function p(){r()&&(n()&&(v=2,b.set("hasTurboAutoOpened","1")),z(w.trb_bid),d.trigger("turbo:checkout:auto:open"))}var g=d.$,v=0,u="trb_open trb_addr trb_qty trb_warrAsin trb_auth trb_sid trb_bid trb_accessoryAsin trb_accessoryOffer".split(" "),w={},z=function(){};return{setup:function(a,b){if(m()){v=1;var e=q.location.href;g.each(u,function(a,b){a=c.getUrlQueryParam(b);w[b]=a;e=c.removeQueryParam(b,a,e)});
l("Parameters:",w);c.replaceHistory(e);"function"===typeof a?z=a:c.logError("Initiate action must be supplied, and it must be a function.");d.on("turbo:checkout:prefetcher:state:dataStale",p);b()}else v=0,l("Disabled")},reset:function(){b.remove("hasTurboAutoOpened")},isAutoOpenEligible:m,isAutoOpenEnabled:n,isAutoOpenReadyToBeOpened:r,updateInputsAndThen:function(a){var b=w.trb_qty,c=w.trb_addr,d=w.trb_warrAsin,l=w.trb_bid,m=w.trb_accessoryAsin,r=w.trb_accessoryOffer;if(b||c||d||l||m||r){b&&e.setQuantity(b);
c&&f.set(c);if(d){k.select(d);var n=k.getLineItem(b)}if(m&&r){h.select(m);var p=h.getLineItem()}a(b,c,n,l,p)}}}});"use strict";g.when("turbo-checkout-page-ready").register("turbo-checkout-utils",function(){function d(){return navigator.userAgent}function a(b,c){if(b===c||"function"===typeof b&&"function"===typeof c)return!0;if(typeof b!==typeof c)return!1;if("object"!==typeof b||null===b||null===c)return b===c||b!==b&&c!==c;var d=Object.getOwnPropertyNames(b);if(d.length!==Object.getOwnPropertyNames(c).length)return!1;
for(var e=0;e<d.length;e++){var h=d[e];if(!b.hasOwnProperty(h)||!c.hasOwnProperty(h)||!a(b[h],c[h]))return!1}return!0}var c={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#039;"};return{logError:function(a,c){g.log(a,"ERROR",c||"turbo-checkout-utils")},logWarning:function(a,c){g.log(a,"WARN",c||"turbo-checkout-utils")},logDebug:function(){},getUserAgent:d,isAndroid:function(){return!!d().match(/[a|A]ndroid/)},isIPhone:function(){return!!d().match(/iPhone/)},isIPad:function(){return!!d().match(/iPad/)},
isInternetExplorer:function(){return!!d().match(/MSIE/)},createFQDN:function(a){/^http/.test(a)||(a=q.location.origin?q.location.origin+a:q.location.protocol+"//"+q.location.hostname+":"+q.location.port+a);return a},getUrlQueryParam:function(a,c){c||(c=q.location.href);a=a.replace(/[\[\]]/g,"\\$\x26");return(a=(new RegExp("[?\x26]"+a+"(\x3d([^\x26#]*)|\x26|#|$)")).exec(c))?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":y},removeQueryParam:function(a,c,d){var b=d;a&&c&&d&&(a=a+"\x3d"+c,b=d.replace(new RegExp("\\?"+
a+"[\x26]?","g"),"?"),b=b.replace(new RegExp("[\x26]?"+a,"g"),""));return b},replaceHistory:function(a){q.history.pushState&&q.history.replaceState(null,q.title,a)},isNonEmptyString:function(a){return"string"===typeof a&&0<a.length},isDeepEquals:a,escapeHtml:function(a){return a.replace(/[&<>"']/g,function(a){return c[a]})}}});"use strict";g.when("turbo-checkout-utils","turbo-checkout-page-ready").register("turbo-checkout-csm",function(d){function a(a,c,d,e){return"function"===typeof q.uet?q.uet.apply(q.uet,
arguments):e||b()}function c(a,b,c){return"function"===typeof q.ues?q.ues.apply(q.ues,arguments):c}function b(){return+new Date}function e(d){function e(){k&&f&&l&&h&&!g&&"function"===typeof u&&(u(k,f,l,h),g=!0)}var f,h,l,k,g=!1,u;this.getId=function(){return d};this.markClick=function(){k=a("tc",d)};this.markFirstByte=function(){f=c("t0",d,b())};this.markAboveTheFold=function(){l=a("af",d);e()};this.markCriticalFeature=function(){h=a("cf",d);e()};this.whenDataSet=function(a){u=a;e()}}function f(a){"undefined"!==
typeof q.ue_t0&&q.ue.count(a,Date.now()-q.ue_t0)}var k=0,h=[];return{createScope:function(){return new e("chk_turbo_"+ ++k)},logCount:function(a,b){b=b||1;d.logDebug("Logging counter "+a+" with value "+b);if(q.ue&&q.ue.count){var c=a+"_time";q.ue.count(a,b);f(c);for(var e=0;e<h.length;++e)q.ue.count(a+"."+h[e],b),f(c+"."+h[e])}},addCounterExtraSuffix:function(a){h.push(a)},timestamp:b}});"use strict";g.when("A","turbo-checkout-csm","turbo-checkout-page-ready").register("turbo-checkout-counter",function(d,
a){var c=0,b=0,e=0,f=0,k=0,h=0,l="u";d.on("turbo:checkout:sheet:beforeOpen",function(){a.logCount("turboCheckoutSheetOpen",c);"u"!==l?(++k,a.logCount("turboCheckoutPrefetchUsed",k),"p"===l?a.logCount("turboCheckoutPrefetchUsedInProgress",k):a.logCount("turboCheckoutPrefetchUsedFull",k)):(++h,a.logCount("turboCheckoutPrefetchMissing",h))});d.on("turbo:checkout:sheet:beforeClose",function(){++b;a.logCount("turboCheckoutSheetClose",b)});d.on("turbo:checkout:prefetcher:state:dataPrefetching",function(){a.logCount("turboCheckoutPrefetchRequested",
e);l="p"});d.on("turbo:checkout:prefetcher:state:dataFresh",function(){++f;a.logCount("turboCheckoutPrefetchAvailable",f);l="a"});d.on("turbo:checkout:prefetcher:state:dataStale",function(){l="u"});return{incrementSheetOpenedCounter:function(){c++},incrementPrefetchCounter:function(){e++},getSheetOpenCount:function(){return c},getPrefetchCount:function(){return e}}});"use strict";g.when("turbo-checkout-page-ready").register("turbo-checkout-cacher",function(){return{createCache:function(d){var a=!1,
c;return function(){a||(c=d(),a=!0);return c}}}});"use strict";g.when("A","turbo-configuration","turbo-checkout-utils","turbo-checkout-counter","turbo-checkout-page-ready").register("turbo-checkout-ref-tagger",function(d,a,c,b){function e(a,c,d){a="chk_"+a+"_"+(c+"_"+b.getPrefetchCount()+"-"+b.getSheetOpenCount());return f(d?a+"_"+d:a)}function f(a){if(!("string"===typeof a&&0<a.length&&64>=a.length&&h.test(a))||l.test(a))throw"Invalid ref tag. This would be filtered and replaced in clickstream. Value \x3d "+
a;return a}var k={ELIGIBILITY:"eligibility",BUY_NOW:"buyNow",CLOSE:"close"},h=/(^[A-z]$|^[A-z][A-z0-9_-]*[A-Za-z0-9]$)/,l=/[_-]{2,}/,n=a.get(a.KEYS.HOST_PAGE_TYPE_IDENTIFIER);return{generateRefTag:function(a,b,c){return"ref_\x3d"+e(a,b,c)},generateValue:e,generateJoinedValue:function(a){if(!a)return e(n,k.BUY_NOW,"fallback");try{var d=a+"_"+(k.BUY_NOW+"_"+b.getPrefetchCount()+"-"+b.getSheetOpenCount());return f(d)}catch(p){return c.logError(p,"turbo-checkout-ref-tagger"),e(n,k.BUY_NOW,"fallback")}},
generateEligibilityValue:function(){return e(n,k.ELIGIBILITY)},ACTIONS:k,TAGS:{TOUCH:"touch",TOUCH_X:"touchX",BACK:"back",ROTATION:"rotation",DONE:"done"}}});"use strict";g.when("A","turbo-checkout-page-ready").register("turbo-checkout-prefetch-timer",function(d){function a(){f||(f=!0,d.trigger("turbo:checkout:timer:onTimeout"))}function c(){if(f)return!0;var a=(new Date).getTime();return e?6E5<=a-e:!1}var b,e,f=!1;return{startTimer:function(){b||(b=q.setTimeout(a,6E5));e||(e=(new Date).getTime())},
isTimeout:c,resetTimer:function(){q.clearTimeout(b);f=!1;e=b=null},checkTimeout:function(){c()&&a()}}});"use strict";g.when("A","jQuery","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-state-handler","turbo-checkout-form","turbo-checkout-buy-now-onclick-handler","turbo-configuration","turbo-checkout-page-ready").register("turbo-checkout-buy-now-button",function(d,a,c,b,e,f,k,h){function l(a,c){b.logDebug("turbo-checkout-buy-now-button",a,c)}function n(b){return b?m(b):a(e.getInitiateSelector())}
function m(d){var e=a("#"+d),f=h.get(h.KEYS.BUY_NOW_CSS_CLASS_TO_RESOLVE_DUPLICATE_BUTTON_ID);if(!f)return e;var k=a("[id\x3d"+d+"]");if(2>k.length)return e;c.logCount("turboCheckoutBuyNowDuplicateIdPresent");l("Duplicate nodes present for BuyNow button ID: #"+d+". Resolving BuyNow button with CSS: "+f);k=k.filter(f);return 1!==k.length?(c.logCount("turboCheckoutBuyNowUnableToResolveButtonIdWithCss"),b.logError("Unable to resolve a unique BuyNow button with CSS: "+f+". Defaulting to first button with ID: #"+
d,"turbo-checkout-buy-now-button",void 0),e):k}function r(b){l("Buy now button clicked");c.logCount("turboCheckoutBuyNowClicked");k.isConflictingOnClickListenerPresent(a(b.currentTarget))&&(A=!0);b&&b.currentTarget&&b.currentTarget.id||(l("Click event target is INVALID. Expected event target with an id. Turbo will NOT show",b),A=!0);if(A)A=!1,l("Buy now button callbacks supressed");else{e.resolveProductState(b.currentTarget.id);l("Calling buy now button callbacks...");var d=!1;for(var h=0;h<t.length;h++)d=
d||t[h]();d?(l("Supressing default buy now button action"),b.preventDefault(),b.stopPropagation(),b.stopImmediatePropagation(),d=!0):d=void 0;if(d)return!1}f.getForms(a(b.currentTarget)).attr("data-action",p());l("Calling default BuyNow action. User will be sent to Checkout SPC. Turbo will NOT show.");c.logCount("turboCheckoutBuyNowDefault");k.callCachedOnClickListenerIfPresent(b.currentTarget,b);return!0}function p(){return n().attr("name")||"submit.buy-now"}function g(a){for(var b=t.length-1;0<=
b;--b)t[b]===a&&t.splice(b,1)}function v(a){if(!a&&1<n().length)throw"Button id parameter is NOT present. Cannot execute action without a button id on a page with multiple buy now buttons!";}function u(a){a=n(a);w(a);a.click()}function w(b){for(var d=h.get(h.KEYS.CONFLICTING_INITIATE_LISTENERS),e=0;e<d.length;e++){var f=d[e];l("Unbound configured event '"+f+"' from buy now button");c.logCount("turboCheckoutBuyNowButtonConflictingListeners");b.unbind(f);a(document.body).undelegate(b.selector,f)}}var q=
h.get(h.KEYS.BUY_NOW_CLICK_EVENT),t=[],A=!1;d.on("turbo:checkout:clickInitiate",u);c.logCount("turboCheckoutBuyNowButtonBound");return{registerOnClickCallback:function(a){g(a);t.push(a)},deregisterOnClickCallback:g,executeOriginalBuyNowAction:function(a){v(a);A=!0;d.trigger("turbo:checkout:buyNowDisabled");d.trigger("turbo:checkout:clickInitiate",a)},executeTurboBuyNowAction:function(a){v(a);A=!1;u(a)},getSubmitAction:p,bindTurboClickEvent:function(a){a=a||n();k.removeConflictingOnClickListenerIfPresentAndCacheIt(a);
a.unbind(q).bind(q,r)},removeConflictingListeners:w,getBuyNowButtons:n}});"use strict";g.when("A","jQuery","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-page-ready").register("turbo-checkout-buy-now-onclick-handler",function(d,a,c,b){function e(b,c){b.each(function(b,d){a(d).removeProp(c)})}function f(b,c){var d=!1;b.each(function(){var b=a(this),e=b.find("[onclick]"),f=b.prop("onclick"),k=e.prop("onclick");return l(f)&&l(k)||1<e.length||!l(f||k)||h(b)!==c?(d=!0,!1):!0});return d}function k(a){return a.prop("onclick")||
a.find("[onclick]").prop("onclick")}function h(a){return a.attr("onclick")||a.find("[onclick]").attr("onclick")}function l(a){return"function"===typeof a}function n(a,c){b.logDebug("turbo-checkout-buy-now-onclick-handler",a,c)}var m;return{callCachedOnClickListenerIfPresent:function(a,b){l(m)&&(n("BuyNow button onclick listener function called."),c.logCount("turboCheckoutBuyNowButtonOnClickListenerCalled"),m.call(a,b.originalEvent))},removeConflictingOnClickListenerIfPresentAndCacheIt:function(a){var b=
k(a),d=h(a);l(b)&&d&&(f(a,d)?(n("[DOM ERROR] Turbo will NOT show. BuyNow button node has INVALID 'onclick' DOM structure.",a),c.logCount("turboCheckoutBuyNowButtonInvalidOnClickDOM")):(n("BuyNow button node has 'onclick' attribute. Removing its listener and caching it.",a),c.logCount("turboCheckoutBuyNowButtonOnClickListenerRemoveAndCache"),m=b,b=a.find("[onclick]"),e(a,"onclick"),e(b,"onclick")))},isConflictingOnClickListenerPresent:function(a){if(a=l(k(a)))n("Turbo will NOT show. BuyNow button node has conflicting 'onclick' listener."),
c.logCount("turboCheckoutBuyNowButtonConflictingOnClickListener");return a}}});"use strict";g.when("A","turbo-checkout-utils","turbo-checkout-buy-now-button","turbo-checkout-page-ready").register("turbo-checkout-buy-now-integration",function(d,a,c){function b(b,c){a.logDebug(b,"turbo-checkout-buy-now-integration",c)}var e=d.$,f=[];d.on("turbo:checkout:page:reappear",function(){b("Removing additional form inputs from form",f);for(var a;(a=f.shift())!==y;)a.remove()});return{isBuyNow:function(a){return a instanceof
e&&a.attr("data-action")===c.getSubmitAction()},checkoutWith:function(c,d){if(Array.isArray(c)&&d instanceof e){var h=d;for(var k=1;0<h.find('input[name\x3d"asin.'+k+'"]').length||0<h.find('input[name\x3d"offeringID.'+k+'"]').length;)k++;h=k;k=[];for(var m=0;m<c.length;m++){var g=c[m];if(g!==y&&g.asin&&g.offerListingId){var p=h;g=[e("\x3cinput /\x3e",{type:"hidden",name:"asin."+p,value:g.asin}),e("\x3cinput /\x3e",{type:"hidden",name:"offeringID."+p,value:g.offerListingId}),e("\x3cinput /\x3e",{type:"hidden",
name:"quantity."+p,value:g.quantity||1})];Array.prototype.push.apply(k,g);h++}else b('Line item inputs are invalid. Expected "asin" and "offerListingId" keys in object. Customer purchase inputs ignored!',g),a.logError('Line item inputs are invalid. Expected "asin" and "offerListingId" keys in object. Customer purchase inputs ignored!')}m=d.find('input[name\x3d"itemCount"]');1===m.length?m.val(h):d.append(e("\x3cinput /\x3e",{type:"hidden",name:"itemCount",value:h}));b("Appended additional buy now inputs.",
k);d.append.apply(d,k);f=k}else h="Inputs are invalid. Expected array and jQuery object. lineItems \x3d "+c+" $form \x3d "+d,b(h,arguments),a.logError(h)}}});"use strict";g.when("turbo-checkout-page-ready").register("turbo-configuration-keys",function(d){var a={HOST_PAGE_TYPE_IDENTIFIER:"HOST_PAGE_TYPE_IDENTIFIER",FORM_TYPE:"FORM_TYPE",FORM_SELECTOR_OVERRIDE:"FORM_SELECTOR_OVERRIDE",BUY_NOW_BUTTON_SELECTOR:"BUY_NOW_BUTTON_SELECTOR",BUY_NOW_BUTTON_V2_SELECTOR:"BUY_NOW_BUTTON_V2_SELECTOR",BUY_NOW_CLICK_EVENT:"BUY_NOW_CLICK_EVENT",
BUY_NOW_CSS_CLASS_TO_RESOLVE_DUPLICATE_BUTTON_ID:"BUY_NOW_CSS_CLASS_TO_RESOLVE_DUPLICATE_BUTTON_ID",QUANTITY_SELECT_SELECTOR:"QUANTITY_SELECT_SELECTOR",ADDRESS_INPUT_SELECTORS:"ADDRESS_INPUT_SELECTORS",SESSION_ID_SELECTOR:"SESSION_ID_SELECTOR",LEGACY_SESSION_ID_IDENTIFIER:"LEGACY_SESSION_ID_IDENTIFIER",WARRANTY_CHECKBOX_INPUT_SELECTOR:"WARRANTY_CHECKBOX_INPUT_SELECTOR",WARRANTY_CHECKBOX_RELATIVE_PARENT_SELECTOR:"WARRANTY_CHECKBOX_RELATIVE_PARENT_SELECTOR",WARRANTY_ASIN_INPUT_NAME:"WARRANTY_ASIN_INPUT_NAME",
WARRANTY_OFFER_INPUT_SELECTOR:"WARRANTY_OFFER_INPUT_SELECTOR",AJAX_PAGE_UPDATE_EVENT:"AJAX_PAGE_UPDATE_EVENT",PREFETCH_TREATMENT:"PREFETCH_TREATMENT",NO_PREFETCH_TREATMENT:"NO_PREFETCH_TREATMENT",BUY_NOW_ONLY_TREATMENT:"BUY_NOW_ONLY_TREATMENT",IS_DEVICE_FILTER_REQUIRED:"IS_DEVICE_FILTER_REQUIRED",IS_SIGN_IN_SUPPORTED:"IS_SIGN_IN_SUPPORTED",USES_MASH_WILL_REAPPEAR:"USES_MASH_WILL_REAPPEAR",SHOW_SIGN_IN_INTERFACE:"SHOW_SIGN_IN_INTERFACE",IFRAME_ID:"IFRAME_ID",EXTEND_ELIGIBLE_STATE:"EXTEND_ELIGIBLE_STATE",
VIEW_ADAPTER:"VIEW_ADAPTER",PAGE_STATE_PARSING_ROOT_NODE_SELECTOR:"PAGE_STATE_PARSING_ROOT_NODE_SELECTOR",PRODUCT_STATE_PARSING_ROOT_NODE_SELECTOR:"PRODUCT_STATE_PARSING_ROOT_NODE_SELECTOR",TURBO_PAGE_STATE_KEY:"TURBO_PAGE_STATE_KEY",TURBO_PRODUCT_STATE_KEY:"TURBO_PRODUCT_STATE_KEY",DEVICE_OVERRIDE:"DEVICE_OVERRIDE",CONFLICTING_INITIATE_LISTENERS:"CONFLICTING_INITIATE_LISTENERS",VAS_CHANGE_EVENTS:"VAS_CHANGE_EVENTS",VAS_CHECKBOX_SELCTOR:"VAS_CHECKBOX_SELCTOR",CHECKBOX_EXCLUSION_ROOT_NODES:"CHECKBOX_EXCLUSION_ROOT_NODES",
MASH_ADAPTER:"MASH_ADAPTER",IS_ADD_TO_CART_ENABLED:"IS_ADD_TO_CART_ENABLED",IS_BUYNOW_ENABLED_FOR_SCREENREADER:"IS_BUYNOW_ENABLED_FOR_SCREENREADER",BACKGROUND_SCROLL_TARGET_SELECTOR:"BACKGROUND_SCROLL_TARGET_SELECTOR",NO_PREFETCH_EXPERIMENT_WEBLABS:"NO_PREFETCH_EXPERIMENT_WEBLABS",ENABLED_ACCESSORIES_SELECTOR:"ENABLED_ACCESSORIES_SELECTOR",OVERRIDE_ELIGIBILITY:"OVERRIDE_ELIGIBILITY",validate:function(c){if("string"!==typeof c||!a[c])throw"The key '"+c+"' is not defined within 'turbo-configuration-keys'.";
}};return a});"use strict";g.when("A","turbo-configuration-keys","turbo-device-configuration","turbo-client-configuration","turbo-eligibility-override","turbo-checkout-page-ready").register("turbo-configuration",function(d,a,c,b,e){function f(a,b){var c=k(a);g[a]=c===y?b:c}function k(a){var d=b[a];a=c[a];if(h(d))return d;if(h(a))return a}function h(a){return"boolean"===typeof a||a}function l(a){if(!h(b[a])&&!h(c[a]))throw"Required configuration override for key '"+a+"' is missing";g[a]=k(a)}var g;
return{get:function(b){a.validate(b);g||(g={},l(a.HOST_PAGE_TYPE_IDENTIFIER),l(a.SHOW_SIGN_IN_INTERFACE),l(a.EXTEND_ELIGIBLE_STATE),l(a.VIEW_ADAPTER),f(a.FORM_TYPE,"form"),f(a.FORM_SELECTOR_OVERRIDE,""),f(a.BUY_NOW_BUTTON_SELECTOR,"#buy-now-button"),f(a.BUY_NOW_BUTTON_V2_SELECTOR,".checkout-buy-now"),f(a.BUY_NOW_CLICK_EVENT,"click.turboCheckout"),f(a.BUY_NOW_CSS_CLASS_TO_RESOLVE_DUPLICATE_BUTTON_ID,""),f(a.QUANTITY_SELECT_SELECTOR,'select[name\x3d"quantity"]'),f(a.SESSION_ID_SELECTOR,""),f(a.LEGACY_SESSION_ID_IDENTIFIER,
""),f(a.ADDRESS_INPUT_SELECTORS,["#unifiedLocation1ClickAddress","#unifiedLocationAddress"]),f(a.WARRANTY_CHECKBOX_INPUT_SELECTOR,".mbb-checkbox input[name\x3dmbba]"),f(a.WARRANTY_CHECKBOX_RELATIVE_PARENT_SELECTOR,".mbb-checkbox-column"),f(a.WARRANTY_ASIN_INPUT_NAME,"mbba"),f(a.WARRANTY_OFFER_INPUT_SELECTOR,"#mbb-offering-id"),f(a.AJAX_PAGE_UPDATE_EVENT,"a:pageUpdate"),f(a.PREFETCH_TREATMENT,"PREFETCH_DISABLED"),f(a.NO_PREFETCH_TREATMENT,"T1"),f(a.BUY_NOW_ONLY_TREATMENT,"BUY_NOW_LAUNCHED"),f(a.IS_DEVICE_FILTER_REQUIRED,
!1),f(a.IS_SIGN_IN_SUPPORTED,!0),f(a.USES_MASH_WILL_REAPPEAR,!1),f(a.IFRAME_ID,"turbo-checkout-iframe"),f(a.PAGE_STATE_PARSING_ROOT_NODE_SELECTOR,"#turboState"),f(a.PRODUCT_STATE_PARSING_ROOT_NODE_SELECTOR,"#turboState"),f(a.TURBO_PAGE_STATE_KEY,"turbo-checkout-page-state"),f(a.TURBO_PRODUCT_STATE_KEY,"turbo-checkout-page-state"),f(a.DEVICE_OVERRIDE,""),f(a.CONFLICTING_INITIATE_LISTENERS,[]),f(a.CHECKBOX_EXCLUSION_ROOT_NODES,"#simpleBundle_feature_div #monthlyPayments_feature_div #bbg_feature_div #addons_feature_div #mobile-accessory-upsell #detailPageGifting_feature_div #twister-plus-feature".split(" ")),
f(a.ENABLED_ACCESSORIES_SELECTOR,".simpleBundleCheckBoxArea"),f(a.MASH_ADAPTER,""),f(a.IS_ADD_TO_CART_ENABLED,!0),f(a.IS_BUYNOW_ENABLED_FOR_SCREENREADER,!0),f(a.BACKGROUND_SCROLL_TARGET_SELECTOR,"#productTitleGroupAnchor"),f(a.VAS_CHANGE_EVENTS,["turbo:checkout:sheet:doClose"]),f(a.VAS_CHECKBOX_SELCTOR,"#vas-checkbox-input"),f(a.VAS_CHANGE_EVENTS,["turbo:checkout:sheet:doClose"]),f(a.VAS_CHECKBOX_SELCTOR,"#vas-checkbox-input"),f(a.NO_PREFETCH_EXPERIMENT_WEBLABS,["RCX_CHECKOUT_TURBO_PRIME_UPSELL_222066"]),
f(a.OVERRIDE_ELIGIBILITY,e));var c=g;return c[b]},KEYS:d.copy(a)}});"use strict";g.when("A","turbo-checkout-utils","turbo-checkout-weblab-allocation","turbo-checkout-state-handler","turbo-checkbox-exclusion-listener","turbo-checkout-content-loader","turbo-checkout-device-filter","turbo-callback-list","turbo-checkout-auto-open","turbo-checkout-vas-input","turbo-checkout-accessories-input","turbo-checkout-page-ready").register("turbo-base-eligible-state",function(d,a,c,b,e,f,k,h,l,g,m){function n(){t=
!0}function p(){t=!1}function B(){var a=new v;k.isDeviceTurboEligible()||a.invalidate("Device is NOT eligible");f.isError()&&!c.isNoPrefetch()&&a.invalidate("Prefetch failed");b.isProductTurboEligible()||a.invalidate("Product is NOT eligible");l.isAutoOpenEnabled()||t||a.invalidate("Cheetah eligibility response is false");c.isControl()&&a.invalidate("Weblab is in CONTROL");c.isBuyNowOnly()&&a.invalidate("Weblab is in buy now only treatment");g.isSelected()&&a.invalidate("Value added service is selected and NOT supported");
m.isEligible()||a.invalidate("Accessory selection was not eligible");e.isAnyCheckboxChecked()&&a.invalidate("Exclusion case checkbox is checked");0!==A("#account-linking").length&&a.invalidate("Account linking checkbox present");w.callAll(a);a.logInvalidState();return a.canShow()}function v(){var b=!0,c=[];this.invalidate=function(a){b=!1;c.push(a)};this.logInvalidState=function(){b||a.logDebug("turbo-base-eligible-state","Cannot show turbo because: "+c)};this.canShow=function(){return b}}function u(a){q.callAll(B(),
a)}var w=h.create(),q=h.create(),t=!1,A=d.$;return{addStateCheck:function(a){w.push(a)},canShow:B,registerStateChangeCallback:function(a){q.push(a)},onStateChange:u,setup:function(){f.registerCallback({onTurboEligible:n,onFinish:n,onTurboIneligible:p});b.registerCallback(u);e.onStateChange(u);g.onChange(u);m.registerCallback(u)}}});"use strict";g.when("A","turbo-callback-list","turbo-checkout-page-ready").register("turbo-checkout-base-view",function(d,a){function c(b){if("string"!==typeof b)throw"Parameter 'iFrameContainerSelector' is not a string.";
this.onBoundsAdjustedCallbacks=a.create();this.IFRAME_CONTAINER_SELECTOR=b}var b=d.$;c.prototype.updateBounds=function(a,b){if("number"!==typeof a)throw'Parameter "iFrameContainerHeightInPixels" is not a number. Cannot validate bounds.';var c=this.$getIFrameContainer().height(),d=a-c,e=c+d;0!==d&&(this.$getIFrameContainer().height(e),this.updateScrollHeight(a,b),a=parseInt(this.$getIFrameContainer().css("min-height"),10),e=e>a?e:a,c!==e&&this.onBoundsAdjustedCallbacks.callAll(e))};c.prototype.updateScrollHeight=
function(a,b){b&&a!==b?(this.$getIFrame().height(b),this.$getIFrameContainer().css("overflow-y","scroll"),this.$getIFrameContainer().css("-webkit-overflow-scrolling","touch")):(this.$getIFrame().height("100%"),this.$getIFrameContainer().css("overflow-y",""),this.$getIFrameContainer().css("-webkit-overflow-scrolling",""))};c.prototype.getHeight=function(){return this.$getIFrameContainer().height()};c.prototype.$getIFrameContainer=function(){return b(this.IFRAME_CONTAINER_SELECTOR)};c.prototype.$getIFrame=
function(){return b(this.IFRAME_CONTAINER_SELECTOR+" iframe")};c.prototype.pushBoundsAdjustedCallback=function(a){this.onBoundsAdjustedCallbacks.push(a)};return{extend:function(){function a(){c.apply(this,arguments)}a.prototype=Object.create(c.prototype);return a.prototype.constructor=a}}});"use strict";g.when("turbo-configuration","turbo-checkout-page-ready").execute("turbo-eligible-state-check",function(d){d.get(d.KEYS.EXTEND_ELIGIBLE_STATE)||g.when("turbo-base-eligible-state").register("turbo-checkout-eligible-state",
function(a){return{canShow:a.canShow,registerStateChangeCallback:a.registerStateChangeCallback,setup:a.setup}})});"use strict";g.when("A","turbo-checkout-state-handler","turbo-configuration","turbo-checkout-utils","turbo-checkout-page-ready").register("turbo-checkout-weblab-allocation",function(d,a,c){function b(){return a.getWeblabAllocation()}function e(){return a.getExperimentName()}function f(){return a.getAdditionalWeblabAndTreatmentMap()}function k(){return"C"===b()}function h(){var a=c.get(c.KEYS.NO_PREFETCH_EXPERIMENT_WEBLABS);
return Array.isArray(a)&&-1!==a.indexOf(e())&&!k()}return{getAllocation:b,getExperimentName:e,getAdditionalWeblabAndTreatmentMap:f,isControl:k,isBuyNowOnly:function(){return b()===c.get(c.KEYS.BUY_NOW_ONLY_TREATMENT)},isDisableTurboWeblabInTreatment:function(){for(var a=f(),b=["RCX_CHECKOUT_DISABLE_TURBO_FOR_NPA_EXPERIMENT_543201","RCX_CHECKOUT_DISABLE_TURBO_FOR_PRIME_MOBILE_EXPERIMENT_601969","RCX_CHECKOUT_DISABLE_TURBO_FOR_PRIME_DESKTOP_EXPERIMENT_601976"],c=0;c<b.length;c++){var d=b[c];if(d in
a&&"T1"===a[d])return!0}return!1},isPrefetch:function(){return!h()&&b()===c.get(c.KEYS.PREFETCH_TREATMENT)},isNoPrefetch:function(){var a=c.get(c.KEYS.NO_PREFETCH_TREATMENT);return h()||!!b().match(a)}}});"use strict";g.when("A","jQuery","turbo-checkout-ajax-wrapper","turbo-checkout-utils","turbo-checkout-urls","turbo-checkout-csm","turbo-checkout-weblab-allocation","turbo-checkout-buy-now-button","turbo-checkout-form","turbo-configuration","turbo-checkout-state-handler","turbo-checkout-eligibility-response-weblabs",
"turbo-checkout-eligible-state","turbo-checkout-page-ready").register("turbo-checkout-weblab-trigger",function(d,a,c,b,e,f,k,h,l,g,m,r,p){function n(){d.on("turbo:checkout:prefetch:onTurboEligible",function(){F=!0;z()})}function v(){d.on("turbo:checkout:prefetch:onTurboIneligible",function(){F=!1;z()})}function u(){d.on("a:pageUpdate",function(){z()})}function w(){d.on("turbo:checkout:auto:open",function(){y()})}function z(){0===t().length?f.logCount("turboCheckoutBuyNowButtonMissing"):0===l.getForms(t()).length&&
f.logCount("turboCheckoutBuyNowFormMissing");0<l.getForms(t()).length&&(F?(b.logDebug("turbo-checkout-weblab-trigger","Adding trigger to form: "+k.getAllocation()),D.val(k.getAllocation()),x.val(k.getExperimentName()),C.val(m.getRequestId()),I.val(m.getSessionId()),l.getForms(t()).append(D,x,C,I)):(b.logDebug("turbo-checkout-weblab-trigger","Removing trigger from form: "+k.getAllocation()),D.remove(),x.remove(),C.remove(),I.remove()))}function t(){var b=g.get(g.KEYS.BUY_NOW_BUTTON_SELECTOR),c=g.get(g.KEYS.BUY_NOW_BUTTON_V2_SELECTOR);
return 0===a(b).length?a(c):a(b)}function A(){if(r.get()&&0<r.get().length||F&&!m.isTurboLaunched()){b.logDebug("turbo-checkout-weblab-trigger","Calling cheetah to trigger: "+k.getAllocation());0<l.getForms(t()).find(D).length||f.logCount("turboCheckoutTriggerMissing");var a=!F||m.isTurboLaunched()?e.buildTriggerWeblabPathWithoutWeblab(m.getRefTag,m.getRequestId(),m.getSessionId()):e.buildTriggerWeblabPathWith(m.getRefTag(),k.getExperimentName(),k.getAllocation(),m.getRequestId(),m.getSessionId());
if(F&&!m.isTurboLaunched()&&p.canShow()){var c=k.getAdditionalWeblabAndTreatmentMap();var d=[],h;for(h in c)c.hasOwnProperty(h)&&d.push({weblabName:h,weblabAllocation:c[h]});c=d}else c=[];y(a,c)}}function y(b,c){c=[].concat(c).concat(r.get());c={additionalWeblabsToTrigger:JSON.stringify(c)};var d="function"===typeof q.Blob;"function"===typeof q.navigator.sendBeacon&&d?(c=new Blob([a.param(c)],{type:"application/x-www-form-urlencoded"}),q.navigator.sendBeacon(b,c)||f.logCount("turboCheckoutTriggerRecordingFailed")):
E(b,c)}function E(a,b){c.load(a,{method:"POST",params:b,error:function(a,b,c){a&&204===a.http.status||f.logCount("turboCheckoutTriggerRecordingFailed")},abort:function(a){f.logCount("turboCheckoutTriggerRecordingFailed")}})}var D,x,C,I,F=!1;return{setup:function(){D=a("\x3cinput/\x3e",{type:"hidden",name:"triggerTurboWeblab",value:""});x=a("\x3cinput/\x3e",{type:"hidden",name:"triggerTurboWeblabName",value:""});C=a("\x3cinput/\x3e",{type:"hidden",name:"turboPageRequestId",value:""});I=a("\x3cinput/\x3e",
{type:"hidden",name:"turboPageSessionId",value:""});u();n();v();h.registerOnClickCallback(A);w()}}});"use strict";g.when("A","turbo-checkout-form","turbo-checkout-utils","turbo-checkout-state-handler","turbo-checkout-page-ready").register("turbo-checkout-page-filter",function(d,a,c,b){function e(a,b){c.logDebug("turbo-checkout-page-filter",a,b)}return{isCurrentViewTurboEligible:function(){var c=d.$(b.getInitiateSelector()),k=a.getForms(c),h=0<c.length&&c.length===k.length;h||(e("Page is NOT turbo eligible. Parent forms / nested links do not match the number of initiate selectors",
c),e("Forms",k));return h}}});"use strict";g.when("turbo-configuration","turbo-checkout-page-ready").execute("turbo-device-filter-check",function(d){d.get(d.KEYS.IS_DEVICE_FILTER_REQUIRED)||g.when("turbo-checkout-cacher","turbo-checkout-page-ready").register("turbo-checkout-device-filter",function(a){var c=function(){return!0};return{isDeviceTurboEligible:a.createCache(c),isSignInSupported:a.createCache(c)}})});"use strict";g.when("A","turbo-checkout-state-handler","turbo-checkout-device-filter",
"turbo-checkout-page-filter","turbo-checkout-weblab-allocation","turbo-checkout-page-ready").register("turbo-checkout-eligibility-aggregator",function(d,a,c,b,e){return{isTurboEligible:function(){return b.isCurrentViewTurboEligible()&&a.isProductTurboEligible()&&!e.isBuyNowOnly()},isSignInSupported:function(){return c.isSignInSupported()&&!e.isBuyNowOnly()},shouldAttemptPrefetch:function(){return c.isDeviceTurboEligible()&&!e.isBuyNowOnly()}}});"use strict";g.when("A","turbo-checkout-ref-tagger",
"turbo-filtered-callback-list","turbo-checkout-state-handler","turbo-checkout-ajax-wrapper","turbo-checkout-utils","turbo-checkout-urls","turbo-checkout-csm","turbo-checkout-eligibility-aggregator","turbo-checkout-eligibility-response-weblabs","turbo-checkout-accessories-input","turbo-checkout-page-ready").register("turbo-checkout-content-loader",function(d,a,c,b,e,f,k,h,l,g,m){function n(c){h.logCount("turboCheckoutInitiate");H();F=!1;I=Date.now();u("Notifying loading callbacks");C="started";N.callAll();
d.trigger("turbo:checkout:prefetch:onStart");h.logCount("turboCheckoutPrefetchStart");var f=c?[]:b.getLineItems(),l=c?a.generateEligibilityValue():b.getRefTag();f=(c?k.buildEligibilityPathWith:k.buildInitiatePathWith)(l,b.getExperimentName(),b.getClientId(),b.getRequestId(),b.getSessionId(),f);x=e.loadWithJQXHR(f,{type:"POST",data:p(c),headers:B(),xhr:v,success:z,error:t})}function p(a){var c={isAsync:1};b.getAddressId()&&(c.addressID=b.getAddressId());b.isPhysicalGiftCardExperimentEligible()&&(c.isPhysicalGiftCard=
!0);if(a&&m.isEligible()&&m.getLineItem()){var d=m.getLineItem();c["offerListing.1"]=d.offerListingId;c["requiresEligibilityCheck.1"]="true"}a||b.getLineItems().forEach(function(a,b){b+=1;c["offerListing."+b]=a.offerListingId;c["quantity."+b]=a.quantity;a.incentivizedCart&&(c["incentivizedCart."+b]=a.incentivizedCart,c.incentivizedCart=a.incentivizedCart);a.customItemPrice&&(c["customItemPrice."+b]=a.customItemPrice,c.customItemPrice=a.customItemPrice);var d=a.addToCartTimeAsUnixEpochMilliseconds;
d&&(c["addToCartTimeAsUnixEpochMilliseconds."+b]=d);(a=a.addToCartSessionId)&&(c["addToCartSessionId."+b]=a)});return c}function B(){var a={"x-amz-support-custom-signin":1};a["x-amz-turbo-checkout-dp-url"]=q.location.href;a["x-amz-checkout-entry-referer-url"]=q.location.href;var c=b.getCSRFToken();c&&0<c.length&&(a["x-amz-checkout-csrf-token"]=c);return a}function v(){var a=e.createXHRRequest();a.addEventListener("readystatechange",function(){if(F||!a.readyState||2>a.readyState)u("Ignoring ready state changed event because headers already received or missing xhr");
else if(F=!0,h.logCount("turboCheckoutPrefetchHeadersReceived"),h.logCount("turboCheckoutPrefetchHeadersReceivedDuration",Date.now()-I),a&&a.getResponseHeader("x-amz-turbo-checkout-eligible")){u("Headers received: Turbo eligible");h.logCount("turboCheckoutTurboEligibleAfterCheetahChecks");var b=a&&a.getResponseHeader("x-amzn-checkout-login-required"),c=l.isSignInSupported();b&&(u("Headers received: Signin required"),h.logCount("turboCheckoutSigninRequired"),c||(u("Sign-in required but it is disabled or not supported."),
h.logCount("turboCheckoutSigninNotSupported")));if(c||!b)u("Notifying turbo eligible callbacks"),R.callAll(),d.trigger("turbo:checkout:prefetch:onTurboEligible");w(a)&&J.callAll(a.getResponseHeader("x-amzn-checkout-login-provider"))}else u("Headers received: Not turbo eligible"),P.callAll(),d.trigger("turbo:checkout:prefetch:onTurboIneligible")});return a}function u(a,b){f.logDebug("turbo-checkout-content-loader",a,b)}function w(a){return l.isSignInSupported()&&a&&a.getResponseHeader("x-amzn-checkout-login-required")}
function z(a,b,c){h.logCount("turboCheckoutPrefetchEnd",Date.now()-I);x=null;b=c&&c.getResponseHeader("x-amz-turbo-checkout-eligible");var e=a&&a.match(E);if(e&&0<e.length)try{var k=D(e[0]);var l=D.parseJSON(k.text())}catch(L){f.logError("Could not extract page state from cheetah page: "+L)}else u("Could not extract page state from response data");k=l&&"turbo"===l.pipelineType;e=l&&l.currentPurchaseId&&0<String(l.currentPurchaseId).trim().length;var m=c.getResponseHeader("x-amzn-experiment-weblabs-to-trigger");
if(m!==y){var p=[];try{p=JSON.parse(m)}catch(L){console.error("Error parsing additional weblabs from xhr response header: ",L)}g.set(p)}k&&!e&&f.logError("No purchaseid provided, cannot show turbo");b&&k&&e?("started"!==C&&f.logError("turbo-checkout-content-loader","Error processing turbo available callbacks. Expected state to be started but was "+C),u("Notifying turbo available callbacks"),C="success",O.callAll(a,l),d.trigger("turbo:checkout:prefetch:onSuccess"),h.logCount("turboCheckoutTurboPrefetchSuccess")):
b&&w(c)?u("Body received: Eligible and sign-in is supported and required."):(u("Body received: No turbo page or not eligible: isTurboEligible: "+b+" isTurboPage: "+k+" hasPurchaseId: "+e),A(),h.logCount("turboCheckoutTurboPrefetchFail"))}function t(a,b,c){h.logCount("turboCheckoutPrefetchEnd");x=null;u("Error while initiate",c);h.logCount("turboCheckoutTurboPrefetchError");"timeout"===b&&h.logCount("turboCheckoutInitiateTimeOut");A()}function A(){"started"!==C&&f.logError("turbo-checkout-content-loader",
"Error processing turbo not available callbacks. Expected state to be started but was "+C);u("Notifying error callbacks");C="error";Q.callAll();d.trigger("turbo:checkout:prefetch:onError")}function H(){x&&x.abort&&(u("Aborting running request..."),x.abort())}var E=/<script.*data-a-state.*checkout:conductor:page.*>.*<\/script>/,D=d.$,x,C="stopped",I,F=!1,N=c.create("onStart"),O=c.create("onFinish"),Q=c.create("onError"),R=c.create("onTurboEligible"),P=c.create("onTurboIneligible"),J=c.create("onSigninRequired");
d.on("turbo:checkout:signInController:onDoSignIn",A);return{registerCallback:function(a){N.push(a);O.push(a);Q.push(a);R.push(a);J.push(a);P.push(a)},callInitiate:function(){u("Calling turbo initiate");n()},checkEligibility:function(){u("Calling turbo eligibility check only");n(!0)},abortCall:H,isSuccess:function(){return"success"===C},isError:function(){return"error"===C},isStarted:function(){return"started"===C}}});"use strict";g.when("A","jQuery","turbo-checkout-ref-tagger","turbo-checkout-utils",
"turbo-checkout-page-ready").register("turbo-checkout-history-manager",function(d,a,c,b){function e(){if(q.history.state&&q.history.state.turboAction)return q.history.state.turboAction}function f(){e();e()||(b.logDebug("turbo-checkout-history-manager","Adding turbo history state"),q.history.pushState({turboAction:"popover"},document.title+" Turbo open"))}var k=!1;a(q).bind("popstate.turbo",function(a){e();k?(b.logDebug("turbo-checkout-history-manager","Trigger Subpanel Back Clicked"),d.trigger("turbo:checkout:dimmer:clicked"),
k=!1,f()):e()?(b.logDebug("turbo-checkout-history-manager","Trigger sheet open"),d.trigger("turbo:checkout:sheet:doOpen")):(b.logDebug("turbo-checkout-history-manager","Trigger sheet close"),d.trigger("turbo:checkout:sheet:doClose",{immediate:!1,reason:c.TAGS.BACK}))});return{sheetOpened:f,sheetClosed:function(){e();e()&&(b.logDebug("turbo-checkout-history-manager","Removing turbo history state"),q.history.back())},subPanelOpened:function(){k=!0},subPanelClosed:function(){k=!1}}});"use strict";g.when("A",
"turbo-checkout-page-ready").register("turbo-base-visibility-manager",function(d){function a(){d.trigger("turbo:checkout:page:gone")}return{setup:function(){d.on("turbo:checkout:sheet:onNavigateAway",a)}}});g.when("turbo-configuration","turbo-checkout-page-ready").execute("turbo-mash-will-reappear-check",function(d){d.get(d.KEYS.USES_MASH_WILL_REAPPEAR)||g.when("turbo-base-visibility-manager").register("turbo-checkout-page-visibility-manager",function(a){return a})});"use strict";g.when("A","jQuery",
"turbo-checkout-view-state","turbo-checkout-weblab-allocation","turbo-checkout-state-handler","turbo-checkout-content-loader","turbo-checkout-prefetch-timer","turbo-checkout-page-visibility-manager","turbo-checkout-counter","turbo-checkout-utils","turbo-checkout-eligibility-aggregator","turbo-checkout-auto-open","turbo-checkout-page-ready").register("turbo-checkout-prefetcher",function(d,a,c,b,e,f,k,h,l,g,m,r){function p(a){var b=v;v=a;g.logDebug("turbo-checkout-prefetcher","Transitioning from "+
b.name+" to "+a.name);if(b.onExit)b.onExit(a.name);if(a.onEnter)a.onEnter(b.name);d.trigger("turbo:checkout:prefetcher:state:"+a.name);d.trigger("turbo:checkout:prefetcher:state",a.name)}var n,v,u=function(){var a=f.isError(),b=!m.isTurboEligible(),c=k.isTimeout(),d=0===n;g.logDebug("turbo-checkout-prefetcher","Test is data stale: isStaleWhenCheetahReturnsError: "+a+" isStaleWhenProductNotEligiblie: "+b+" isStaleWhenTimeoutOccurs: "+c+" isStaleWhenNoMorePrefetchesAvailable: "+d);return a||b||c||d},
w=function(){var a=m.isTurboEligible()&&!k.isTimeout()&&0<n;g.logDebug("turbo-checkout-prefetcher","Test should prefetch: eligibilityAggregator.isTurboEligible(): "+m.isTurboEligible()+" !timer.isTimeout(): "+!k.isTimeout()+" _prefetchesAvailable: "+n);return a},q={name:"start",onEvent:function(a){m.shouldAttemptPrefetch()?"controller:onPageLoaded"===a&&p(t):p(E)},onExit:function(){e.startMonitoringPage()}},t={name:"dataStale",onEvent:function(a){"page:gone"!==a&&"prefetch:onError"!==a&&"sheet:afterClose"!==
a&&w()&&p(A)}},A={name:"dataPrefetching",onEnter:function(){l.incrementPrefetchCounter();b.isPrefetch()||c.isOpeningOrOpen()||r.isAutoOpenReadyToBeOpened()?f.callInitiate():f.checkEligibility();--n},onEvent:function(a){if("page:gone"===a)p(t);else{var c=f.isSuccess()&&b.isPrefetch(),d=f.isSuccess()&&b.isNoPrefetch();g.logDebug("turbo-checkout-prefetcher","Test is data fresh: isFreshWhenPrefetchResultOKInT1: "+c+" isFreshWhenPrefetchResultOKInT4: "+d);c||d?p(y):u()?p(t):"product:onChange"===a&&w()&&
p(A)}},onExit:function(a){"dataFresh"!==a&&f.abortCall()}},y={name:"dataFresh",onEnter:function(){k.startTimer()},onEvent:function(a){"page:gone"===a?p(t):u()?p(t):(c.isClosed()||"product:onChange"===a)&&w()&&p(A)},onExit:function(){k.resetTimer()}},E={name:"end"},D="controller:onPageLoaded sheet:beforeOpen sheet:afterClose product:onChange prefetch:onSuccess prefetch:onError timer:onTimeout page:gone page:reappear".split(" "),x={"sheet:beforeOpen":function(){n=10}};return{setup:function(){n=10;v=
q;a.each(D,function(a,b){var c=x[b];d.on("turbo:checkout:"+b,function(a){g.logDebug("turbo-checkout-prefetcher","Processing "+b);c&&c();if(v.onEvent)v.onEvent(b)})})},getState:function(){return v.name}}});"use strict";g.when("A","turbo-signin-adapter","turbo-checkout-content-loader","turbo-checkout-buy-now-button","turbo-checkout-csm","turbo-checkout-weblab-allocation","turbo-checkout-utils","turbo-callback-list","turbo-checkout-state-handler","turbo-checkout-eligible-state","turbo-checkout-page-ready").register("turbo-checkout-signin-controller",
function(d,a,c,b,e,f,k,h,l,g){function m(){w=!1}function n(a){w=!0;z=a;e.logCount("turboCheckoutSigninRequired")}function p(){var b=w&&g.canShow();b&&(k.logDebug("turbo-checkout-signin-controller","Showing sign in dialog"),e.logCount("turboCheckoutSigninPopup"),a.show(z,q,v),d.trigger("turbo:checkout:signInController:onDoSignIn"));return b}function q(){k.logDebug("turbo-checkout-signin-controller","Signin success");e.logCount("turboCheckoutSigninSuccess");u.callAll()}function v(){k.logDebug("turbo-checkout-signin-controller",
"Signin failed");e.logCount("turboCheckoutSigninFailed")}var u=h.create(),w=!1,z;return{setup:function(){c.registerCallback({onStart:m,onSigninRequired:n});b.registerOnClickCallback(p)},registerCallback:u.push}});"use strict";g.when("A","turbo-configuration","turbo-callback-list","turbo-filtered-callback-list","turbo-checkout-page-ready").register("turbo-checkout-iframe",function(d,a,c,b){function e(){return d.$("#"+g)}function f(){if(!(0<e().length))throw"Attempted to read / write the iFrame without it being in the DOM. This would result in an undefined iFrame document.";
var a=e()[0];return a.contentDocument||a.contentWindow.document}function k(){if(0<e().length)throw"Attempted to insert multiple Turbo Checkout iFrames";}function h(){return d.$("\x3ciframe/\x3e",{id:g,src:"about:blank",scrolling:"no","class":"turbo-checkout-blank"})}function l(a){p.push(a)}var g=a.get(a.KEYS.IFRAME_ID),m=b.create("beforeFramePopulated"),q=b.create("afterFramePopulated"),p=c.create();l(function(a){a.addClass("turbo-checkout-shown")});d.on("turbo:checkout:iframe:document:loaded",function(){p.callAll(e())});
return{write:function(a){m.callAll();a+='\x3cscript\x3e"use strict";window.parent.P.now("turbo-checkout-controller").execute("callbackPageController", function callbackPageController(controller) {controller.frameHtmlRendered();});P.when("load").execute("onTurboDocumentLoaded", function onTurboDocumentLoaded() {window.parent.P.when("A").execute("triggerTurboDocumentLoaded", function triggerTurboDocumentLoaded(A) {A.trigger("turbo:checkout:iframe:document:loaded");});});\x3c/script\x3e';if("string"!==
typeof a)throw"Attempted to write non-string value to iFrame. typeof \x3d "+typeof a;var b=f();b.open();b.write(a);b.close();q.callAll(e()[0])},remove:function(){e().remove()},appendTo:function(a){k();a.append(h())},insertInto:function(a){k();a.html(h())},hasContent:function(){var a=0<e().length&&f();return a&&(a.body.hasChildNodes()||a.head.hasChildNodes())},registerCallbacks:function(a){m.push(a);q.push(a)},onContentLoaded:l}});"use strict";g.when("A","turbo-checkout-page-ready").register("turbo-checkout-view-state",
function(d){function a(a,b){return function(){return e===a||e===b}}function c(a){return function(){e=a;b.apply(b,arguments)}}function b(a,b){a&&"string"===typeof a&&d.trigger(a,b)}var e=0;return{isClosed:a(0),isClosing:a(1),isOpen:a(2),isOpening:a(3),isClosingOrClosed:a(1,0),isOpeningOrOpen:a(3,2),setToOpen:c(2),setToOpening:c(3),setToClosed:c(0),setToClosing:c(1)}});"use strict";g.when("A","turbo-view-adapter","turbo-checkout-view-state","turbo-checkout-eligible-state","turbo-checkout-content-loader",
"turbo-checkout-utils","turbo-checkout-weblab-allocation","turbo-checkout-weblab-trigger","turbo-checkout-csm","turbo-checkout-state-handler","turbo-checkout-device-filter","turbo-checkout-ajax-wrapper","turbo-checkout-page-visibility-manager","turbo-checkout-counter","turbo-checkout-prefetcher","turbo-checkout-prefetch-timer","turbo-checkout-buy-now-button","turbo-checkout-signin-controller","turbo-checkout-auto-open","turbo-checkout-urls","turbo-checkout-ref-tagger","turbo-configuration","turbo-checkout-event-verification",
"turbo-checkout-page-ready").register("turbo-checkout-controller",function(d,a,c,b,e,f,k,h,g,n,m,q,p,B,v,u,w,z,t,y,H,E,D){function l(){w.bindTurboClickEvent();d.off("turbo:checkout:dimmer:clicked");d.on("turbo:checkout:dimmer:clicked",function(a){a()})}function r(a,b){f.logDebug("turbo-checkout-controller",a,b)}function A(b,c){J();b||a.close({reason:c})}function F(){r("Handling signin success");O()}function N(){r("Handling buy now button click");O();return!0}function O(){V=setTimeout(Q,2E4);K=g.createScope();
K.markClick();M="loading";T=!1;u.checkTimeout();B.incrementSheetOpenedCounter();a.show()}function Q(){g.logCount("turboCheckoutContenLoadTimeout")}function R(){J();a.removeContent()}function P(){J();D.logBuyNowButtonClickHandlerMetrics()}function J(){b.canShow()&&!k.isDisableTurboWeblabInTreatment()?(r("Registering with buy now button"),d.trigger("turbo:checkout:buyNowEnabled"),w.registerOnClickCallback(N)):(r("Unregistering from buy now button"),d.trigger("turbo:checkout:buyNowDisabled"),w.deregisterOnClickCallback(N))}
function X(b,c){g.logCount("turboCheckoutPrefetchSuccess");b&&(k.isControl()||k.isBuyNowOnly())&&(r("Received content in control: "+b.substring(0,255)),g.logCount("turboCheckoutControlContentReceived"));U=c;a.setContent(b);J()}function Y(){J();c.isOpeningOrOpen()&&(g.logCount("turboCheckoutYieldNewPurchase"),a.closeImmediatelyThenExecute(L))}function Z(){clearTimeout(V);M="unknown";!G||G.isResolved()||G.isRejected()||(r("Initiate confirm called for "+U.currentPurchaseId+" with existing confirm still executing. Aborting"),
g.logCount("turboCheckoutConfirmPending"),G._supersedByNewPurchase=!0,G.abort());ba()}function aa(){var a=n.getLineItems().filter(function(a){return a&&a.isDiscoveredAsin}).map(function(a,b){return a.asin});g.logCount("turboCheckoutDiscoveredAsins",a.length);return a}function ba(){g.logCount("turboCheckoutConfirm");var b=U.currentPurchaseId,c=y.buildConfirmPathWith(n.getRefTag(),k.getExperimentName(),n.getClientId(),n.getRequestId(),n.getSessionId(),aa());G=q.loadWithJQXHR(c,{type:"POST",data:{pid:b},
headers:ca(),success:function(a,b,c){g.logCount("turboCheckoutConfirmSuccess")},error:function(c,d,e){"abort"===d?g.logCount("turboCheckoutConfirmAborted"):("timeout"===d&&g.logCount("turboCheckoutConfirmTimeOut"),g.logCount("turboCheckoutConfirmFailed"));c._supersedByNewPurchase||(f.logError("Issue confirming turbo initiate prefetch for pid "+b+": "+e+", "+d),g.logCount("turboCheckoutYieldNewPurchase"),a.closeImmediatelyThenExecute(L))}})}function ca(){var a={},b=n.getCSRFToken();b&&0<b.length&&
(a["x-amz-checkout-csrf-token"]=b);return a}function da(){K.markFirstByte()}function S(){return E.get(E.KEYS.HOST_PAGE_TYPE_IDENTIFIER)}function L(){w.executeOriginalBuyNowAction(n.getActiveId())}function ea(a){d.trigger("turbo:checkout:embedded:page:showSpinner");G.done(a)}function fa(a,b,c){M=c;T=!1}function ha(){T=!0}function ia(a){d.off("turbo:checkout:dimmer:clicked");d.on("turbo:checkout:dimmer:clicked",function(a){a()});a&&a.doNotLog||(a&&!a.doNotLog?W(M,a.reason):W(M,!1));M="closed"}function W(a,
b){var c=y.buildLogPageHitPathWith(T?a+"2":a,b,n.getClientId());r("Logging page hit from "+a+" to "+S()+" reason "+b);q.load(c,{method:"POST",params:{pageType:S(),referrer:a},timeout:4E3})}function ja(){c.isOpeningOrOpen()&&g.logCount("turboCheckoutProductChangedWhileOpening")}var K,M,U,T;H=E.get(E.KEYS.AJAX_PAGE_UPDATE_EVENT);var V,G;d.on(H,l);l();return{pageLoaded:function(){var c=k.getExperimentName();if(c){var f=k.getAllocation();g.addCounterExtraSuffix("wl:"+f);g.addCounterExtraSuffix(c+":"+
f)}m.isDeviceTurboEligible()&&(b.setup(),b.registerStateChangeCallback(A),p.setup(),e.registerCallback({onStart:R,onTurboEligible:P,onFinish:X,onError:Y}),h.setup(),z.setup(),z.registerCallback(F),K=g.createScope(),a.registerCallbacks({beforeFramePopulated:Z,afterFramePopulated:da}),n.registerCallback(ja),d.on("turbo:checkout:sheet:beforeClose",ia),d.on("turbo:checkout:embedded:page:beforeReload",fa),d.on("turbo:checkout:embedded:page:animation:start",ha),t.setup(w.executeTurboBuyNowAction,P),v.setup(),
d.trigger("turbo:checkout:controller:onPageLoaded"))},loadFullscreen:function(b,c){function d(){b=f.createFQDN(b);"thankyou"===c?(g.logCount("turboCheckoutYieldTYP"),"primewardrobe"===n.getClientId()&&g.logCount("turboCheckoutYieldTYP:pw"),a.closeAndNavigate(b)):"thirdPartyPaymentInterstitial"===c?a.closeAndNavigate(b):"verifyMfaPage"===c?("primewardrobe"===n.getClientId()&&g.logCount("turboCheckoutYieldTYP:pw"),a.closeAndNavigate(b)):(g.logCount("turboCheckoutYield"),a.closeToFullscreen(b))}!G||
G.isResolved()||G.isRejected()?d():(g.logCount("turboCheckoutWaitYield"),ea(d))},frameContentReady:function(a,b,c){d.trigger("turbo:checkout:embedded:page:ready",a,b);(function(){var a=function(){K.markCriticalFeature();c.confirmHit(S(),n.getRefTag());K.whenDataSet(c.recordClientSideMetrics);b.off("checkout:afterReload",a)};b.on("checkout:afterReload",a)})();(function(){b.on("checkout:beforeReload",function(c){d.trigger("turbo:checkout:embedded:page:beforeReload",a,b,c)});b.on("checkout:reload",function(c){d.trigger("turbo:checkout:embedded:page:reload",
a,b,c)});b.on("checkout:afterReload",function(c){d.trigger("turbo:checkout:embedded:page:afterReload",a,b,c)});b.on("turbo:checkout:animation:start",function(){d.trigger("turbo:checkout:embedded:page:animation:start")});d.on("turbo:checkout:embedded:page:showSpinner",function(){c.showSpinner()});d.off("turbo:checkout:dimmer:clicked");d.on("turbo:checkout:dimmer:clicked",function(a){b.trigger("turbo:checkout:dimmer:clicked:iFrame",a)});b.on("turbo:checkout:update:dimmer",function(a){d.trigger("turbo:checkout:update:dimmer:afterReload",
a)});b.on("turbo:checkout:update:modal:header",function(a){d.trigger("turbo:checkout:update:modal:header:afterReload",a)});b.on("turbo:checkout:update:dimmer:block",function(){d.trigger("turbo:checkout:update:dimmer:block:iFrame")});b.on("turbo:checkout:update:dimmer:unblock",function(){d.trigger("turbo:checkout:update:dimmer:unblock:iFrame")})})()},frameHtmlRendered:function(){K.markAboveTheFold()},updateBounds:function(b,c){a.updateBounds(b,c)},getHeight:function(){return a.getHeight()},updateMinHeight:function(b){return a.updateMinHeight(b)},
updateScrollHeight:function(b,c){return a.updateScrollHeight(b,c)},updateDimmer:function(a){d.trigger("turbo:checkout:update:dimmer:typReload",a)},getHostPageType:S}});"use strict";g.when("turbo-checkout-page-load-spinner","turbo-checkout-controller","turbo-checkout-csm","turbo-checkout-page-state","turbo-constants","turbo-checkout-page-ready").register("turbo-checkout-startup",function(d,a,c,b,e){b.get().turboAssetsMode!==e.ASSET_MODE_CLT_CX_ONLY&&(d.removePageLoadSpinner(),c.logCount("turboCheckoutControllerPageLoaded"),
a.pageLoaded())});"use strict";g.when("turbo-checkout-assets-load-trigger").register("turbo-checkout-page-ready",function(){q.ue&&q.ue.count&&"undefined"!==typeof q.ue_t0&&q.ue.count("turboCheckoutPageReady",Date.now()-q.ue_t0)});"use strict";g.when("A","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-state-handler","turbo-checkout-quantity-input","turbo-checkout-warranty-input","turbo-checkout-accessories-input","turbo-checkout-page-ready").register("turbo-checkout-authportal-return-query",
function(d,a,c,b,e,f,g){function h(a){c.logDebug("turbo-checkout-authportal-return-query",a)}function k(a){return!!a.match("trb_auth\x3d1")}function n(d){if(k(d)){d=((d||"").match(p)||[])[1]||"";var e=b.getSessionId();c.isNonEmptyString(d)||a.logCount("turboCheckoutPostAuthEmptySessionParameter");c.isNonEmptyString(e)||a.logCount("turboCheckoutPostAuthEmptySessionPageState");c.isNonEmptyString(d)&&c.isNonEmptyString(e)&&d!==e&&(c.logWarning("Turbo Session Flip Detected. Post authentication sessionId \x3d "+
e+", Expected \x3d "+d,"turbo-checkout-authportal-return-query"),a.logCount("turboCheckoutPostAuthSessionFlip"))}}var m=/&?(openid|aToken|serial)[^&]*/g,r=/&?trb_(open|auth|qty|warrAsin|sid|accessory(Asin|Offer))=[^&]*/g,p=/&?trb_sid=([^&]*)/,B=/\?[?&]*/,v=/[?&]{2,}/g;n(q.location.search);return{buildFrom:function(a){h("Initial Query \x3d "+a);a=(a||"?").replace(m,"");a=a.replace(r,"");a+="\x26trb_auth\x3d1\x26trb_open\x3d1";var c=e.getQuantity();a+=1<c?"\x26trb_qty\x3d"+c:"";c=f.getLineItem();a+=
c&&c.asin?"\x26trb_warrAsin\x3d"+c.asin:"";c=b.getSessionId();a+=0<c.length?"\x26trb_sid\x3d"+c:"";c=b.getActiveId();a+=c?"\x26trb_bid\x3d"+c:"";c=g.getLineItem();a+=c&&c.asin&&c.offerListingId?"\x26trb_accessoryAsin\x3d"+c.asin+"\x26trb_accessoryOffer\x3d"+c.offerListingId:"";a=a.replace(B,"?").replace(v,"\x26");h("Final Query \x3d "+a);return a},isReturningFromAuthPortal:k,validateSession:n}});"use strict";g.when("turbo-checkout-utils","turbo-checkout-csm","turbo-checkout-authportal-return-query",
"turbo-checkout-page-ready").register("turbo-checkout-signin-utils",function(d,a,c){function b(a){return null!==a.match(f)}function e(){var a=c.buildFrom(q.location.search);return encodeURIComponent("https://"+q.location.hostname+q.location.pathname.replace(g,"/ref\x3dtrb_chk_auth")+a)}var f=/openid\.return_to=([^&$]+)/,g=/(\/ref=[^/]*\/?$|\/?$)/;return{encodeSignInUrl:function(c){if(b(c)){a.logCount("turboCheckoutForceMobileClaimCollection");var h=c.match(f)[1],g=decodeURIComponent(h);h===g&&d.logError("The pre-defined returnTo seems to be un-encoded");
g=encodeURIComponent(g+(-1===g.indexOf("?")?"?":"\x26")+"openid.return_to\x3d"+e());return c.replace(h,g)}return c+(-1===c.indexOf("?")?"?":"\x26")+"openid.return_to\x3d"+e()},isEnforceMobileClaimUrl:function(a){var b=null!==a.match("openid.pape.preferred_auth_policies%3DEnforcePossessionOnMobileClaim")||null!==a.match(decodeURIComponent("openid.pape.preferred_auth_policies%3DEnforcePossessionOnMobileClaim"));a=null!==a.match("intercept%3Dfalse")||null!==a.match(decodeURIComponent("intercept%3Dfalse"));
return b&&a},_isReturnToParameterPredefined:b}});"use strict";g.when("turbo-checkout-utils","turbo-checkout-csm","turbo-checkout-auto-open","turbo-checkout-authportal-return-query","turbo-checkout-signin-utils","turbo-checkout-page-ready").register("turbo-checkout-browser-signin",function(d,a,c,b,e){function f(){var b=q.location.search.match(g)?"turboCheckoutSigninSuccess":"turboCheckoutSigninFailed";a.logCount(b)}var g=/openid\.mode=id_res/;b.isReturningFromAuthPortal(q.location.search)&&(a.logCount("turboCheckoutAuthPortalReturn"),
f());return{show:function(b){b=e.encodeSignInUrl(b);a.logCount("turboCheckoutSignInUrlSize",b.length);c.reset();q.location.assign(b)}}});"use strict";g.when("turbo-checkout-utils","turbo-checkout-state-handler","turbo-checkout-page-ready").register("turbo-checkout-strings",function(d,a){function c(b){return function(){var c=a.getStrings()[b];if(c)return d.escapeHtml(c);d.logDebug("turbo-checkout-strings",'String for key "'+b+'" is undefined! Returning empty string.');return""}}return{getHeaderText:c("TURBO_CHECKOUT_HEADER"),
getLoadingText:c("TURBO_LOADING_TEXT")}});"use strict";g.when("jQuery","turbo-checkout-page-ready").register("turbo-checkout-loading-spinner",function(d){function a(){return d("#turbo-loading-container")}function c(a){var b=d("\x3cdiv\x3e",{id:"turbo-loading-content"}).append(d("\x3cdiv\x3e",{id:"turbo-loading-spinner","class":"a-spinner a-spinner-medium"}));"string"===typeof a&&a&&b.append(d("\x3cdiv\x3e",{id:"turbo-loading-text",text:a}));return b}return{create:function(a){return d("\x3cdiv\x3e",
{id:"turbo-loading-container"}).append(c(a))},get:a,show:function(){a().addClass("turbo-checkout-shown")}}});"use strict";g.when("A","turbo-checkout-utils","turbo-checkout-page-ready").register("turbo-checkout-eligibility-response-weblabs",function(d,a){var c=[];return{set:function(a){d.$.isArray(a)&&(c=a)},get:function(){return c}}});"use strict";g.when("turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-page-ready").register("turbo-checkout-session-storage",function(d,a){function c(b,c){a.logDebug("turbo-checkout-session-storage",
b,c)}return{isPresent:function(a){a:{try{var b=q.sessionStorage.getItem(a);break a}catch(f){d.logCount("turboCheckoutSessionStorageExceptionGet"),c("get() exception",f)}b=null}return null!==b&&b!==y},set:function(a,e){try{q.sessionStorage.setItem(a,e)}catch(f){d.logCount("turboCheckoutSessionStorageExceptionSet"),c("set() exception",f)}},remove:function(a){try{return q.sessionStorage.removeItem(a)}catch(e){d.logCount("turboCheckoutSessionStorageExceptionRemove"),c("remove() exception",e)}}}});"use strict";
g.when("A","turbo-configuration","turbo-checkout-page-ready").register("turbo-checkout-load-events",function(d,a){var c=a.get(a.KEYS.AJAX_PAGE_UPDATE_EVENT);return{bind:function(a){d.off(c,a);d.off("turbo:checkout:controller:onPageLoaded",a);d.on(c,a);d.on("turbo:checkout:controller:onPageLoaded",a)}}});"use strict";g.when("A","jQuery","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-buy-now-button","turbo-configuration","turbo-checkout-page-ready").register("turbo-checkout-event-verification",
function(d,a,c,b,e,f){function g(){var a=f.get(f.KEYS.BUY_NOW_CLICK_EVENT).split(".");return 1<a.length?a[1]:"turboCheckout"}function h(a){var b=a.map(function(a){return a.namespace}).filter(function(a,b,c){return c.indexOf(a)===b});a.length!==b.length&&c.logCount("turboCheckoutBuyNowButtonDuplicateClickHandler")}function l(a){if((a=a.filter(function(a){return a!==y&&"click"===a.type&&0<=q.indexOf(a.namespace)}))&&0<a.length){var b=0;a.forEach(function(a){a.namespace!==g()&&(c.logCount("turboCheckoutBuyNowButtonClickHandlerWhitelisted:"+
a.namespace),b++)});0<b&&c.logCount("turboCheckoutBuyNowButtonClickHandlerWhitelistedQuantity:"+b)}}function n(a){if((a=a.filter(function(a){return a!==y&&"click"===a.type&&0>q.indexOf(a.namespace)}))&&0<a.length){var b=0;a.forEach(function(){c.logCount("turboCheckoutBuyNowButtonClickHandlerNotWhitelisted");b++});c.logCount("turboCheckoutBuyNowButtonClickHandlerNotWhitelistedQuantity:"+b)}}var m=!1,q=[g(),"accessoryUpsellInterstitial","makoPreRegistration","moq","siatc","hctpDFL","bbg","vasBuyNow",
"ppdBundles","makoGiftingMetrics","financialOptionsCheckout"];return{logBuyNowButtonClickHandlerMetrics:function(){var d=e.getBuyNowButtons();if(!m&&d&&0<d.length){for(var f=0;f<d.length;f++){var g=a._data(d[f],"events");if(!g||!g.click){c.logCount("turboCheckoutBuyNowButtonNoBoundHandlers");return}var k=(g=g.click)?g.length:0;1<k&&(b.logDebug("turbo-checkout-event-verification","Multiple handlers bound to 'click' in Buy Now button. Number of handlers: "+k,void 0),c.logCount("turboCheckoutBuyNowButtonMultipleClickEventsBound"),
c.logCount("turboCheckoutBuyNowButtonMultipleClickEventsBoundQuantity:"+k));h(g);n(g);l(g)}m=!0}}}});"use strict";g.when("turbo-checkout-page-ready").register("turbo-constants",function(){return{ASSET_MODE_TURBO_ONLY:"TURBO_ONLY",ASSET_MODE_CLT_CX_ONLY:"CLT_CX_ONLY",ASSET_MODE_TURBO_AND_CLT_CX:"TURBO_AND_CLT_CX"}});"use strict";g.when("turbo-checkout-state-handler","turbo-checkout-page-ready").register("turbo-shopping-portal-switch",function(d){return{isShoppingPortalEnabled:function(){var a=d.getClientId();
return!("primewardrobe"===a||"primestylist"===a)}}})});
/* ******** */
(function(f){var p=window.AmazonUIPageJS||window.P,r=p._namespace||p.attributeErrors,a=r?r("TurboCheckoutDesktopAssets",""):p;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,p,r){f.when("turbo-configuration-keys","turbo-checkout-page-ready").register("turbo-device-configuration",function(a){if(!c){var c={};c[a.SHOW_SIGN_IN_INTERFACE]="turbo-checkout-browser-signin";c[a.EXTEND_ELIGIBLE_STATE]=!1;c[a.IS_DEVICE_FILTER_REQUIRED]=!0;c[a.VIEW_ADAPTER]="turbo-checkout-modal";
c[a.WARRANTY_CHECKBOX_INPUT_SELECTOR]="input[id^\x3dmbb-offeringID-]";c[a.WARRANTY_CHECKBOX_RELATIVE_PARENT_SELECTOR]=".abbListItem";c[a.WARRANTY_OFFER_INPUT_SELECTOR]="input[id^\x3dmbb-offeringID-]:checked";c[a.WARRANTY_ASIN_INPUT_NAME]="asin"}return c});"use strict";f.when("A","turbo-checkout-csm","turbo-checkout-utils","turbo-configuration","turbo-checkout-device-variant","turbo-checkout-is-touch-and-orientation-enabled","turbo-checkout-page-ready").register("turbo-checkout-device-filter",function(a,
c,g,f,h,p){function k(a){var b=!1;this.countOnce=function(){b||(c.logCount(a),b=!0)}}function d(a){g.logDebug("turbo-checkout-device-filter",a)}var r="turboCheckoutDisabledDesktopAuiVariant"+h,l,b,y,u,t,m,v;return{isDeviceTurboEligible:function(){l=l||new k("Desktop"===h?"turboCheckoutDesktopAuiVariantEligible":r);var e;(e=b)||(e=g.isInternetExplorer()?"turboCheckoutDisabledDesktopIE":g.isIPad()?"turboCheckoutDisabledDesktopIPad":g.isIPhone()?"turboCheckoutDisabledDesktopIPhone":g.isAndroid()?"turboCheckoutDisabledDesktopAndroid":
"turboCheckoutDesktopUserAgentEligible",e=new k(e));b=e;y=y||new k("turboCheckoutDisabledDesktopTouch");u=u||new k("turboCheckoutDisabledDesktopOrientation");t=t||new k("turboCheckoutDisabledDesktopTouchAndOrientation");m=m||new k("turboCheckoutDisabledTurboDesktopOnDevice");v=v||new k("turboCheckoutEnabledTurboDesktopOnDevice");l.countOnce();"Desktop"===h||d("Aui device variant is NOT Desktop. Turbo will NOT show. Variant is "+h);(e="Desktop"!==h)||(b.countOnce(),e=!!(g.isInternetExplorer()||g.isIPad()||
g.isAndroid()||g.isIPhone()));if(e)return m.countOnce(),!1;if(e=a.capabilities.touch)y.countOnce(),d("Touch enabled device. Turbo will NOT show");var c=a.capabilities.orientation;c&&(u.countOnce(),d("Orientation enabled device. Turbo will NOT show"));e&&c&&t.countOnce();if((e||c)&&!p)return m.countOnce(),!1;v.countOnce();return!0},isSignInSupported:function(){return f.get(f.KEYS.IS_SIGN_IN_SUPPORTED)}}});"use strict";f.when("turbo-checkout-page-ready").execute(function(){f.declare("turbo-checkout-device-variant",
"Desktop")});"use strict";f.when("A","a-modal","turbo-checkout-csm","turbo-checkout-utils","turbo-checkout-iframe","turbo-checkout-base-view","turbo-checkout-loading-spinner","turbo-checkout-view-state","turbo-checkout-ref-tagger","turbo-checkout-strings","turbo-checkout-page-ready").register("turbo-checkout-modal",function(a,c,f,F,h,G,k,d,z,l){function b(a){F.logDebug("turbo-checkout-modal",a)}function g(){!A()||d.isOpeningOrOpen()?b("show() suppressed. View is null or undefined or view state is opening or open"):
(d.setToOpening(),m().show())}function u(){w&&d.isOpeningOrOpen()&&(h.appendTo(e()),h.write(w))}function t(){h.remove();if(0<e().length)b("Modal frame is in DOM. Inserting Spinner"),e().height("").html(k.create(l.getLoadingText())).append(v()),q("#turbo-checkout-modal-header").text(l.getHeaderText());else{b("Modal frame is NOT in DOM. Resetting Modal");var a={inlineContent:q("\x3cdiv\x3e",{id:"turbo-checkout-frame"}).html(k.create(l.getLoadingText())).append(v()).prop("outerHTML"),padding:"none",
dataStrategy:"inline",header:'\x3cdiv id\x3d"turbo-checkout-modal-header"\x3e'+l.getHeaderText()+"\x3c/div\x3e"};m().update(a)}}function m(){return B=B||c.get(q("#turbo-checkout-modal"))}function v(){return q("\x3cscript/\x3e",{type:"text/javascript",html:'P.when("A").execute(function turboFrameReady(A) { A.trigger("turbo:checkout:frame:ready"); });'})}function e(){return q("#turbo-checkout-frame")}function x(a){!A()||d.isClosingOrClosed()?b("close() suppressed. View is undefined or null or view state is closing or closed"):
(n=a||n,n.notify=!0===n.notify||n.notify===r,d.setToClosing(),m().hide())}function A(){var a=m();a||b("Modal is undefined or null. Modal \x3d "+a);return a?!0:!1}function C(b){q(document.body).unbind("click");b();a.trigger("turbo:checkout:sheet:onNavigateAway");x({notify:!1,immediate:!0,doNotLog:!0})}function D(a){b("onDismiss");n={notify:!0,reason:a}}var q=a.$,n={},w,B,E=new (G.extend())("#turbo-checkout-frame");h.onContentLoaded(function(a){k.get().remove()});a.on("a:popover:dismiss:turbo",function(){b("onClick_X");
D(z.TAGS.TOUCH_X)});a.declarative("a-popover-floating-close","click",function(){b("onDimmerClicked");D(z.TAGS.TOUCH)});a.on("a:popover:beforeShow:turbo",function(){b("onBeforeOpen");d.setToOpening("turbo:checkout:sheet:beforeOpen");t()});a.on("a:popover:show:turbo",function(){b("onOpen");d.setToOpen();w||k.show()});a.on("a:popover:beforeHide:turbo",function(){b("onBeforeClose");d.setToClosing.apply(d,!0===n.notify?["turbo:checkout:sheet:beforeClose",n]:r);e().removeClass("turbo-checkout-shown")});
a.on("a:popover:hide:turbo",function(){b("onClose");d.setToClosed("turbo:checkout:sheet:afterClose");n={}});a.on("a:popover:afterHide:turbo",t);a.on("turbo:checkout:sheet:doOpen",g);a.on("turbo:checkout:sheet:doClose",x);a.on("turbo:checkout:frame:ready",u);a.on(a.constants.BROWSER_EVENTS.ORIENTATION_CHANGE,function(){f.logCount("turboCheckoutDesktopOrientationChange");d.isOpen()&&f.logCount("turboCheckoutDesktopOrientationChangeWhenModalOpen")});a.on("turbo:checkout:state:product:resolved",function(){q("#turbo-checkout-modal-header").text(l.getHeaderText())});
a.on("turbo:checkout:update:modal:header:afterReload",function(a){null!==a&&q("#turbo-checkout-modal-header").text(a)});return{show:g,setContent:function(a){w=a;b("iFrame content saved");d.isOpeningOrOpen()?u():(b("setFrameContent NOT called"),b("viewState is not opening? isOpeningOrOpen \x3d "+d.isOpeningOrOpen()),b("iFrame already has content? iFrame.hasContent \x3d "+h.hasContent()))},removeContent:function(){w="";t()},close:x,closeToFullscreen:function(a){C(function(){p.location.href=a})},closeImmediatelyThenExecute:C,
closeAndNavigate:function(b){p.location.href=b;a.trigger("turbo:checkout:sheet:onNavigateAway");x({notify:!1,doNotLog:!0})},registerCallbacks:h.registerCallbacks,updateBounds:function(a){E.updateBounds(a)},getHeight:function(){return E.getHeight()}}});"use strict";f.declare("turbo-checkout-is-touch-and-orientation-enabled",!1)});
/* ******** */
(function(c){var d=window.AmazonUIPageJS||window.P,e=d._namespace||d.attributeErrors,a=e?e("DetailPageTurboCheckoutDesktopAssets",""):d;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,d,e){c.when("turbo-configuration-keys","turbo-product-state-key","turbo-state-parsing-root-node-selector","turbo-checkout-page-ready").register("turbo-client-configuration",function(a,c,d){var b;b||(b={},b[a.HOST_PAGE_TYPE_IDENTIFIER]="detail",b[a.BUY_NOW_ONLY_TREATMENT]="T1",b[a.NO_PREFETCH_TREATMENT]=
/T[2-9]/,b[a.ADDRESS_INPUT_SELECTORS]=["#unifiedLocation1ClickAddress","#addToCart input[name\x3d'dropdown-selection']","#unifiedLocationAddress","input[name\x3d'dropdown-selection']"],b[a.QUANTITY_SELECT_SELECTOR]="#quantity",b[a.CONFLICTING_INITIATE_LISTENERS]=["click.siatc"],b[a.VAS_CHANGE_EVENTS]=["vas:remove-service-asin-buybox-event","vas:add-service-asin-buybox-event"],b[a.VAS_CHECKBOX_SELCTOR]="#ppdb-add-service-checkbox",b[a.SESSION_ID_SELECTOR]='input[name\x3d"session-id"]',b[a.TURBO_PRODUCT_STATE_KEY]=
c,b[a.PAGE_STATE_PARSING_ROOT_NODE_SELECTOR]=d,b[a.PRODUCT_STATE_PARSING_ROOT_NODE_SELECTOR]=d);return b});"use strict";c.when("turbo-checkout-page-ready").execute(function(){c.declare("turbo-product-state-key","turbo-checkout-page-state")});"use strict";c.when("turbo-checkout-page-ready").execute(function(){c.declare("turbo-state-parsing-root-node-selector","#turboState")})});
/* ******** */
